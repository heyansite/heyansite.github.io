(window.webpackJsonp=window.webpackJsonp||[]).push([[201],{891:function(s,e,a){"use strict";a.r(e);var t=a(0),r=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"博客部署的一些改进"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#博客部署的一些改进"}},[s._v("#")]),s._v(" 博客部署的一些改进")]),s._v(" "),a("p",[s._v("目前博客的开发流程是")]),s._v(" "),a("ul",[a("li",[s._v("本地编写markdown，然后启动vuepress本地服务，查看效果")]),s._v(" "),a("li",[s._v("没问题后，build静态文件")]),s._v(" "),a("li",[s._v("之后copy到本地docker的html文件夹下面，查看效果")]),s._v(" "),a("li",[s._v("最后scp到云服务器的html文件夹下面")])]),s._v(" "),a("p",[s._v("等博客基本稳定后，主要就是写markdown然后build上传，所以不需要本地验证了，所以想把build之后的动作自动化掉。步骤如下：")]),s._v(" "),a("h4",{attrs:{id:"安装sshpass"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装sshpass"}},[s._v("#")]),s._v(" 安装sshpass")]),s._v(" "),a("p",[s._v("为了能在scp时指定密码，写在shell脚本里面，需要先安装辅助工具sshpass，安装步骤（只针对mac系统）")]),s._v(" "),a("ul",[a("li",[s._v("下载：http://sourceforge.net/projects/sshpass/files/sshpass/1.06/sshpass-1.06.tar.gz")]),s._v(" "),a("li",[s._v("解压到当前文件夹 "),a("code",[s._v("tar -zxvf sshpass-1.06.tar.gz")])]),s._v(" "),a("li",[s._v("进入解压后的文件夹 "),a("code",[s._v("cd sshpass-1.06")])]),s._v(" "),a("li",[s._v("开始源代码安装第一步:检验环境 "),a("code",[s._v("./configure")])]),s._v(" "),a("li",[s._v("编译源代码 "),a("code",[s._v("make&&make install")])])]),s._v(" "),a("h4",{attrs:{id:"写个脚本release-sh，放到-builds文件夹下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写个脚本release-sh，放到-builds文件夹下"}},[s._v("#")]),s._v(" 写个脚本release.sh，放到/builds文件夹下")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start cp files from /vuepress_workspace/blog/docs/.vuepress/dist/* to /docker_workspace/nginx_blog/html"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /Users/heyan/self/workspace/docker_workspace/nginx_blog/html/*\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clean docker html folder complete"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -rf /Users/heyan/self/workspace/vuepress_workspace/blog/docs/.vuepress/dist/* /Users/heyan/self/workspace/docker_workspace/nginx_blog/html\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cp  file to docker folder complete"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start scp files from /docker_workspace/nginx_blog/html/* to root@heyan.site:/home/nginx_blog/html"')]),s._v("\nsshpass -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxxxxx"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@heyan.site "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rm -rf /home/nginx_blog/html/*"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clean the remote server html folder complete"')]),s._v("\nsshpass -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxxxxx"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" -r /Users/heyan/self/workspace/docker_workspace/nginx_blog/html/* root@heyan.site:/home/nginx_blog/html\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scp files to server complete"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h4",{attrs:{id:"修改package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改package-json"}},[s._v("#")]),s._v(" "),a("strong",[s._v("修改package.json")])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"docs:build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vuepress build docs && sh ./builds/release.sh"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("br"),s._v(" "),a("br"),s._v(" "),a("p",[s._v("这样每次run build命令，就会自动build，之后把文件copy到本地的docker目录，再然后上传到远程的docker目录")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run docs:build\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);