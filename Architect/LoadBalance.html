<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Load Balance | Yan&#39;s Blog Home</title>
    <meta name="description" content="Personal blog site">
    
    
    <link rel="preload" href="/assets/css/0.styles.659f981c.css" as="style"><link rel="preload" href="/assets/js/app.2ba1140b.js" as="script"><link rel="preload" href="/assets/js/2.858e58ff.js" as="script"><link rel="preload" href="/assets/js/3.753236a7.js" as="script"><link rel="prefetch" href="/assets/js/10.5dcc1f52.js"><link rel="prefetch" href="/assets/js/100.0327e00b.js"><link rel="prefetch" href="/assets/js/101.404f187c.js"><link rel="prefetch" href="/assets/js/102.d78878ec.js"><link rel="prefetch" href="/assets/js/103.a682f6f1.js"><link rel="prefetch" href="/assets/js/104.d831bcb5.js"><link rel="prefetch" href="/assets/js/105.afbf1884.js"><link rel="prefetch" href="/assets/js/106.8e9709d3.js"><link rel="prefetch" href="/assets/js/107.9712aa22.js"><link rel="prefetch" href="/assets/js/108.4158fdb6.js"><link rel="prefetch" href="/assets/js/109.ae61a303.js"><link rel="prefetch" href="/assets/js/11.34e3d90e.js"><link rel="prefetch" href="/assets/js/110.0abce6c9.js"><link rel="prefetch" href="/assets/js/111.b5c958e5.js"><link rel="prefetch" href="/assets/js/112.fdacfaf6.js"><link rel="prefetch" href="/assets/js/113.9d95243d.js"><link rel="prefetch" href="/assets/js/114.f759f9b9.js"><link rel="prefetch" href="/assets/js/115.1b1f9f3d.js"><link rel="prefetch" href="/assets/js/116.1e5e62e4.js"><link rel="prefetch" href="/assets/js/117.952db9d4.js"><link rel="prefetch" href="/assets/js/118.ed9df468.js"><link rel="prefetch" href="/assets/js/119.f19ee9e0.js"><link rel="prefetch" href="/assets/js/12.cd237cda.js"><link rel="prefetch" href="/assets/js/120.24dbecef.js"><link rel="prefetch" href="/assets/js/121.0aa2d47c.js"><link rel="prefetch" href="/assets/js/122.5205ca42.js"><link rel="prefetch" href="/assets/js/123.25aa20a6.js"><link rel="prefetch" href="/assets/js/124.420b2a92.js"><link rel="prefetch" href="/assets/js/125.091331f4.js"><link rel="prefetch" href="/assets/js/126.471b335f.js"><link rel="prefetch" href="/assets/js/127.60ffdb36.js"><link rel="prefetch" href="/assets/js/128.9c5c36ef.js"><link rel="prefetch" href="/assets/js/129.36fd802b.js"><link rel="prefetch" href="/assets/js/13.de2ffe9f.js"><link rel="prefetch" href="/assets/js/130.822de8a4.js"><link rel="prefetch" href="/assets/js/131.697750e2.js"><link rel="prefetch" href="/assets/js/132.fd5faa78.js"><link rel="prefetch" href="/assets/js/133.cf327ef4.js"><link rel="prefetch" href="/assets/js/134.6cdb8690.js"><link rel="prefetch" href="/assets/js/135.906c8800.js"><link rel="prefetch" href="/assets/js/136.43585d13.js"><link rel="prefetch" href="/assets/js/137.3c7ddb41.js"><link rel="prefetch" href="/assets/js/138.e3274ead.js"><link rel="prefetch" href="/assets/js/139.7fa38b58.js"><link rel="prefetch" href="/assets/js/14.9d6406e7.js"><link rel="prefetch" href="/assets/js/140.1b026dad.js"><link rel="prefetch" href="/assets/js/141.c1adfec5.js"><link rel="prefetch" href="/assets/js/142.ed2a4a22.js"><link rel="prefetch" href="/assets/js/143.af96e2f9.js"><link rel="prefetch" href="/assets/js/144.923a7d38.js"><link rel="prefetch" href="/assets/js/145.d88163de.js"><link rel="prefetch" href="/assets/js/146.2134dd3e.js"><link rel="prefetch" href="/assets/js/147.9925c468.js"><link rel="prefetch" href="/assets/js/148.109297cc.js"><link rel="prefetch" href="/assets/js/149.ae529d47.js"><link rel="prefetch" href="/assets/js/15.fe3428fa.js"><link rel="prefetch" href="/assets/js/150.6bf9657f.js"><link rel="prefetch" href="/assets/js/151.603cf1f9.js"><link rel="prefetch" href="/assets/js/152.b64ef399.js"><link rel="prefetch" href="/assets/js/153.fd5cde7c.js"><link rel="prefetch" href="/assets/js/154.8cedd5d3.js"><link rel="prefetch" href="/assets/js/155.042308eb.js"><link rel="prefetch" href="/assets/js/156.1f58dd5a.js"><link rel="prefetch" href="/assets/js/157.69e07481.js"><link rel="prefetch" href="/assets/js/158.40b656df.js"><link rel="prefetch" href="/assets/js/159.823c56a4.js"><link rel="prefetch" href="/assets/js/16.7976352c.js"><link rel="prefetch" href="/assets/js/160.93aba24e.js"><link rel="prefetch" href="/assets/js/161.3ae7729a.js"><link rel="prefetch" href="/assets/js/162.8092cc22.js"><link rel="prefetch" href="/assets/js/163.3c82e51b.js"><link rel="prefetch" href="/assets/js/164.d358ee7b.js"><link rel="prefetch" href="/assets/js/165.60d778eb.js"><link rel="prefetch" href="/assets/js/166.54d7340a.js"><link rel="prefetch" href="/assets/js/167.5fd6aaa3.js"><link rel="prefetch" href="/assets/js/168.205929f8.js"><link rel="prefetch" href="/assets/js/169.873b90b1.js"><link rel="prefetch" href="/assets/js/17.72e8ffa6.js"><link rel="prefetch" href="/assets/js/170.68c49359.js"><link rel="prefetch" href="/assets/js/171.d8f93304.js"><link rel="prefetch" href="/assets/js/172.6b496cc7.js"><link rel="prefetch" href="/assets/js/173.f276a0ce.js"><link rel="prefetch" href="/assets/js/174.09cb41e2.js"><link rel="prefetch" href="/assets/js/175.c77ce8d9.js"><link rel="prefetch" href="/assets/js/176.01ab9f3f.js"><link rel="prefetch" href="/assets/js/177.2f91a2a4.js"><link rel="prefetch" href="/assets/js/178.5f0a0527.js"><link rel="prefetch" href="/assets/js/179.0d14e948.js"><link rel="prefetch" href="/assets/js/18.8264b169.js"><link rel="prefetch" href="/assets/js/180.9a15f295.js"><link rel="prefetch" href="/assets/js/181.d5bcbada.js"><link rel="prefetch" href="/assets/js/182.571b87a8.js"><link rel="prefetch" href="/assets/js/183.b87f5a38.js"><link rel="prefetch" href="/assets/js/184.90ecbd35.js"><link rel="prefetch" href="/assets/js/185.3a38f733.js"><link rel="prefetch" href="/assets/js/186.881a0fab.js"><link rel="prefetch" href="/assets/js/187.17663dea.js"><link rel="prefetch" href="/assets/js/188.471fcd9b.js"><link rel="prefetch" href="/assets/js/189.6d486653.js"><link rel="prefetch" href="/assets/js/19.e6227b20.js"><link rel="prefetch" href="/assets/js/190.357b4cc8.js"><link rel="prefetch" href="/assets/js/191.ccf9ae83.js"><link rel="prefetch" href="/assets/js/192.3ee45cf5.js"><link rel="prefetch" href="/assets/js/193.2fbcbc68.js"><link rel="prefetch" href="/assets/js/194.61d0acd9.js"><link rel="prefetch" href="/assets/js/195.33b772c3.js"><link rel="prefetch" href="/assets/js/196.7d35848a.js"><link rel="prefetch" href="/assets/js/197.4b958d27.js"><link rel="prefetch" href="/assets/js/198.dfbfba98.js"><link rel="prefetch" href="/assets/js/199.f6c7aacb.js"><link rel="prefetch" href="/assets/js/20.65ad9b00.js"><link rel="prefetch" href="/assets/js/200.6a05302e.js"><link rel="prefetch" href="/assets/js/201.be446c97.js"><link rel="prefetch" href="/assets/js/202.d058ca1d.js"><link rel="prefetch" href="/assets/js/203.ef2b609c.js"><link rel="prefetch" href="/assets/js/204.dab38ee5.js"><link rel="prefetch" href="/assets/js/21.300f7dfb.js"><link rel="prefetch" href="/assets/js/22.0ed457bc.js"><link rel="prefetch" href="/assets/js/23.9cf0f43d.js"><link rel="prefetch" href="/assets/js/24.f151ffcb.js"><link rel="prefetch" href="/assets/js/25.680a763b.js"><link rel="prefetch" href="/assets/js/26.6a5f804d.js"><link rel="prefetch" href="/assets/js/27.98408441.js"><link rel="prefetch" href="/assets/js/28.acbefbd1.js"><link rel="prefetch" href="/assets/js/29.fbd2340a.js"><link rel="prefetch" href="/assets/js/30.30b44255.js"><link rel="prefetch" href="/assets/js/31.510d262b.js"><link rel="prefetch" href="/assets/js/32.c204bc79.js"><link rel="prefetch" href="/assets/js/33.5fa66039.js"><link rel="prefetch" href="/assets/js/34.6db47b26.js"><link rel="prefetch" href="/assets/js/35.fcb88dd5.js"><link rel="prefetch" href="/assets/js/36.e294e99d.js"><link rel="prefetch" href="/assets/js/37.fe541556.js"><link rel="prefetch" href="/assets/js/38.94af8189.js"><link rel="prefetch" href="/assets/js/39.e7017f9b.js"><link rel="prefetch" href="/assets/js/4.1c3159e6.js"><link rel="prefetch" href="/assets/js/40.b7a1deeb.js"><link rel="prefetch" href="/assets/js/41.ae4d7d1e.js"><link rel="prefetch" href="/assets/js/42.5dc5c7f6.js"><link rel="prefetch" href="/assets/js/43.73610732.js"><link rel="prefetch" href="/assets/js/44.2b0e19f3.js"><link rel="prefetch" href="/assets/js/45.903efdc0.js"><link rel="prefetch" href="/assets/js/46.0684656f.js"><link rel="prefetch" href="/assets/js/47.6425b35e.js"><link rel="prefetch" href="/assets/js/48.43663ba9.js"><link rel="prefetch" href="/assets/js/49.34841bc0.js"><link rel="prefetch" href="/assets/js/5.d3774f5f.js"><link rel="prefetch" href="/assets/js/50.48ce1d7e.js"><link rel="prefetch" href="/assets/js/51.1820aa29.js"><link rel="prefetch" href="/assets/js/52.5317c537.js"><link rel="prefetch" href="/assets/js/53.71b86df9.js"><link rel="prefetch" href="/assets/js/54.31ed2a5e.js"><link rel="prefetch" href="/assets/js/55.4f9933ab.js"><link rel="prefetch" href="/assets/js/56.beb74e07.js"><link rel="prefetch" href="/assets/js/57.705bc19e.js"><link rel="prefetch" href="/assets/js/58.f5fd656b.js"><link rel="prefetch" href="/assets/js/59.cc8ae217.js"><link rel="prefetch" href="/assets/js/6.f082ca37.js"><link rel="prefetch" href="/assets/js/60.fc3cf484.js"><link rel="prefetch" href="/assets/js/61.b5032b43.js"><link rel="prefetch" href="/assets/js/62.64d7637a.js"><link rel="prefetch" href="/assets/js/63.2a71075b.js"><link rel="prefetch" href="/assets/js/64.21eb4820.js"><link rel="prefetch" href="/assets/js/65.11535a8c.js"><link rel="prefetch" href="/assets/js/66.d9c62638.js"><link rel="prefetch" href="/assets/js/67.5782c958.js"><link rel="prefetch" href="/assets/js/68.35886dae.js"><link rel="prefetch" href="/assets/js/69.934aa057.js"><link rel="prefetch" href="/assets/js/7.9a79fd87.js"><link rel="prefetch" href="/assets/js/70.53c7c7a2.js"><link rel="prefetch" href="/assets/js/71.0e82b1c6.js"><link rel="prefetch" href="/assets/js/72.1da0eaf9.js"><link rel="prefetch" href="/assets/js/73.3dabc9cd.js"><link rel="prefetch" href="/assets/js/74.b2ae43f6.js"><link rel="prefetch" href="/assets/js/75.55bf2044.js"><link rel="prefetch" href="/assets/js/76.2f88e50b.js"><link rel="prefetch" href="/assets/js/77.d916e87e.js"><link rel="prefetch" href="/assets/js/78.0e80a77d.js"><link rel="prefetch" href="/assets/js/79.03bce65e.js"><link rel="prefetch" href="/assets/js/8.60d5a8a9.js"><link rel="prefetch" href="/assets/js/80.96678f59.js"><link rel="prefetch" href="/assets/js/81.75ffa4d3.js"><link rel="prefetch" href="/assets/js/82.41c1aeb7.js"><link rel="prefetch" href="/assets/js/83.16d5e455.js"><link rel="prefetch" href="/assets/js/84.195ca01f.js"><link rel="prefetch" href="/assets/js/85.d850d4dd.js"><link rel="prefetch" href="/assets/js/86.32d87d56.js"><link rel="prefetch" href="/assets/js/87.5f97a4f6.js"><link rel="prefetch" href="/assets/js/88.f5b0bbdb.js"><link rel="prefetch" href="/assets/js/89.9f9150f5.js"><link rel="prefetch" href="/assets/js/9.74db15a0.js"><link rel="prefetch" href="/assets/js/90.f69286ce.js"><link rel="prefetch" href="/assets/js/91.c9995055.js"><link rel="prefetch" href="/assets/js/92.e992da4f.js"><link rel="prefetch" href="/assets/js/93.14137340.js"><link rel="prefetch" href="/assets/js/94.c8228a63.js"><link rel="prefetch" href="/assets/js/95.bbb7ce03.js"><link rel="prefetch" href="/assets/js/96.ce87793d.js"><link rel="prefetch" href="/assets/js/97.4fdd8a0b.js"><link rel="prefetch" href="/assets/js/98.74cfc635.js"><link rel="prefetch" href="/assets/js/99.abdd1b46.js">
    <link rel="stylesheet" href="/assets/css/0.styles.659f981c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Yan's Blog Home</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Blog Home</a></div><div class="nav-item"><a href="/index/" class="nav-link">Technical Blog Home</a></div><div class="nav-item"><a href="https://heyan.site:8003/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Other Blog Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/comments.html" class="nav-link">留言</a></div><div class="nav-item"><a href="http://heyan.site/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Site Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Blog Home</a></div><div class="nav-item"><a href="/index/" class="nav-link">Technical Blog Home</a></div><div class="nav-item"><a href="https://heyan.site:8003/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Other Blog Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/comments.html" class="nav-link">留言</a></div><div class="nav-item"><a href="http://heyan.site/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Site Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>负载均衡</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Architect/LoadBalance.html" class="active sidebar-link">Load Balance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#什么是负载均衡" class="sidebar-link">什么是负载均衡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#什么是高可用" class="sidebar-link">什么是高可用</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#常见的负载均衡案例" class="sidebar-link">常见的负载均衡案例</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#互联网分布式系统解决方案" class="sidebar-link">互联网分布式系统解决方案</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#服务端、客户端负载均衡" class="sidebar-link">服务端、客户端负载均衡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#服务端负载均衡" class="sidebar-link">服务端负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#客户端负载均衡" class="sidebar-link">客户端负载均衡</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#负载均衡分类-（分布式架构下的负载均衡）" class="sidebar-link">负载均衡分类 （分布式架构下的负载均衡）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#二层负载均衡" class="sidebar-link">二层负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#三层负载均衡" class="sidebar-link">三层负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#四层负载均衡" class="sidebar-link">四层负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#七层负载均衡" class="sidebar-link">七层负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#实践应用" class="sidebar-link">实践应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#负载均衡算法" class="sidebar-link">负载均衡算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#静态均衡算法" class="sidebar-link">静态均衡算法</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#动态负债均衡算法" class="sidebar-link">动态负债均衡算法</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#网站负载均衡技术-一些手段" class="sidebar-link">网站负载均衡技术-一些手段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#_1-http重定向负载均衡" class="sidebar-link">(1) HTTP重定向负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#_2-dns域名解析负载均衡" class="sidebar-link">(2) DNS域名解析负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#_3-反向代理负载均衡" class="sidebar-link">(3) 反向代理负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#_4-ip负载均衡" class="sidebar-link">(4) IP负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#_5-数据链路层负载均衡" class="sidebar-link">(5) 数据链路层负载均衡</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#lvs负载均衡机制" class="sidebar-link">LVS负载均衡机制</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#负载方案构想" class="sidebar-link">负载方案构想</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#方案一：独立的nginx-haproxy方案" class="sidebar-link">方案一：独立的Nginx/Haproxy方案</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#方案二：nginx-haproxy-keepalived-heartbeat方案" class="sidebar-link">方案二：Nginx/Haproxy + Keepalived/Heartbeat方案</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#方案三：lvs-dr-keepalived-heartbeat-nginx-haproxy方案" class="sidebar-link">方案三：LVS(DR) + Keepalived/Heartbeat + Nginx/Haproxy方案</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#方案四：dns轮询-智能dns-lvs-dr-keepalived-nginx方案" class="sidebar-link">方案四：DNS轮询/智能DNS + LVS(DR) + Keepalived + Nginx方案</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#为什么没有独立的lvs方案" class="sidebar-link">为什么没有独立的LVS方案</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#术语说明" class="sidebar-link">术语说明</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#硬件负载" class="sidebar-link">硬件负载</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#nginx-keepalived-lvs-f5-架构设计" class="sidebar-link">nginx/keepalived/lvs/f5 架构设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#单机" class="sidebar-link">单机</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#dns轮询" class="sidebar-link">DNS轮询</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#nginx" class="sidebar-link">nginx</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#keepalived" class="sidebar-link">keepalived</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#lvs-f5-nginx" class="sidebar-link">lvs/f5/nginx</a></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#水平扩展" class="sidebar-link">水平扩展</a></li></ul></li><li class="sidebar-sub-header"><a href="/Architect/LoadBalance.html#四层-七层构建大规模集群架构使用场景" class="sidebar-link">四层 + 七层构建大规模集群架构使用场景</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Microservice</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Serverless 架构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务器专题</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/index/" class="sidebar-link">&lt; 首页</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="load-balance"><a href="#load-balance" class="header-anchor">#</a> Load Balance</h1> <div class="custom-block tip"><p class="custom-block-title">此文为转载 （通常一篇文章会参考多处，也会添加自己的理解，引用地址如有遗漏，请指出）</p> <ul><li><a href="https://segmentfault.com/a/1190000019789819" target="_self" rel="noopener noreferrer">https://segmentfault.com/a/1190000019789819</a></li> <li><a href="https://segmentfault.com/a/1190000018694867" target="_self" rel="noopener noreferrer">https://segmentfault.com/a/1190000018694867</a></li> <li><a href="https://blog.csdn.net/cywosp/article/details/38014581" target="_self" rel="noopener noreferrer">https://blog.csdn.net/cywosp/article/details/38014581</a></li> <li><a href="https://blog.csdn.net/yinwenjie/article/details/46605451" target="_self" rel="noopener noreferrer">https://blog.csdn.net/yinwenjie/article/details/46605451</a></li> <li><a href="https://blog.51cto.com/hzcto/2382282" target="_self" rel="noopener noreferrer">https://blog.51cto.com/hzcto/2382282</a></li> <li><a href="https://blog.csdn.net/qq_43011640/article/details/102690356" target="_self" rel="noopener noreferrer">https://blog.csdn.net/qq_43011640/article/details/102690356</a></li></ul></div> <p>关于负载均衡，这里转载了多篇文章从不同的角度、叙述方式、知识点结构来共同帮助理解。旨在看完本文的所有点后，对负载均衡有个全面的认识。(<em>每个二级标题是单独的文章；所有文章并无关联，知识点可能有重复...</em>)</p> <br> <br> <h2 id="什么是负载均衡"><a href="#什么是负载均衡" class="header-anchor">#</a> <strong>什么是负载均衡</strong></h2> <p>负载均衡（LB，Load Balance），是一种技术解决方案。用来在多个资源（一般是服务器）中分配负载，达到最优化资源使用，避免过载。</p> <h3 id="什么是高可用"><a href="#什么是高可用" class="header-anchor">#</a> <strong>什么是高可用</strong></h3> <p>CAP 定理是分布式系统的基础，也是分布式系统的 3 个指标：</p> <ul><li>Consistency（一致性）</li> <li>Availability（可用性）</li> <li>Partition tolerance（分区容错性）</li></ul> <p>那高可用（High Availability）是什么？高可用，简称 HA，是系统一种特征或者指标，通常是指，提供一定性能上的服务运行时间，高于平均正常时间段。反之，消除系统服务不可用的时间。衡量系统是否满足高可用，就是当一台或者多台服务器宕机的时候，系统整体和服务依然正常可用。</p> <p>总而言之，负载均衡（Load Balance）是分布式系统架构设计中必须考虑的因素之一。一般通过负载均衡，冗余同一个服务实例的方式，解决分布式系统的大流量、高并发和高可用的问题。负载均衡核心关键：在于是否分配均匀。</p> <h3 id="常见的负载均衡案例"><a href="#常见的负载均衡案例" class="header-anchor">#</a> <strong>常见的负载均衡案例</strong></h3> <p>场景1：微服务架构中，网关路由到具体的服务实例 hello：</p> <ul><li>两个相同的服务实例 hello service ，一个端口 8000 ，另一个端口 8082</li> <li>通过 Kong 的负载均衡 LB 功能，让请求均匀的分发到两个 hello 服务实例</li> <li>Kong 的负载均衡策略算法很多：默认 weighted-round-robin 算法，还有 consumer: consumer id 作为 hash 算法输入值等</li></ul> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <p>场景2：微服务架构中，A 服务调用 B 服务的集群。通过了 Ribbon 客户端负载均衡组件：</p> <ul><li>负载均衡策略算法并不高级，最简单的是随机选择和轮循</li></ul> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <h3 id="互联网分布式系统解决方案"><a href="#互联网分布式系统解决方案" class="header-anchor">#</a> <strong>互联网分布式系统解决方案</strong></h3> <div style="display:flex;"><img src="/assets/img/lb-3.01f3f440.png" alt="" align="left" style="zoom:120%;display:block;"></div> <p>常见的互联网分布式系统架构分为几层，一般如下：</p> <ul><li>客户端层：比如用户浏览器、APP 端</li> <li>反向代理层：技术选型 Nignx 或者 F5 等</li> <li>Web 层：前后端分离场景下， Web 端可以用 NodeJS 、 RN 、Vue</li> <li>业务服务层：用 Java 、Go，一般互联网公司，技术方案选型就是 SC 或者 Spring Boot + Dubbo 服务化</li> <li>数据存储层：DB 选型 MySQL ，Cache 选型 Redis ，搜索选型 ES 等</li></ul> <p>一个请求从第 1 层到第 4 层，层层访问都需要负载均衡。即每个上游调用下游多个业务方的时候，需要均匀调用。这样整体系统来看，就比较负载均衡.</p> <p><strong>第 1 层：客户端层 -&gt; 反向代理层 的负载均衡</strong></p> <p>客户端层 -&gt; 反向代理层的负载均衡如何实现呢？ - DNS负载均衡</p> <p>答案是：DNS 的轮询。 DNS 可以通过 A （Address，返回域名指向的 IP 地址）设置多个 IP 地址。比如这里访问 bysocket.com 的 DNS 配置了 ip1 和 ip2 。为了反向代理层的高可用，至少会有两条 A 记录。这样冗余的两个 ip 对应的 nginx 服务实例，防止单点故障。</p> <p>每次请求 bysocket.com 域名的时候，通过 DNS 轮询，返回对应的 ip 地址，每个 ip 对应的反向代理层的服务实例，也就是 nginx 的外网ip。这样可以做到每一个反向代理层实例得到的请求分配是均衡的。</p> <p><strong>第 2 层：反向代理层 -&gt; Web 层 的负载均衡</strong></p> <p>反向代理层 -&gt; Web 层 的负载均衡如何实现呢？</p> <p>是通过反向代理层的负载均衡模块处理。比如 nginx 有多种均衡方法：</p> <ul><li>请求轮询。请求按时间顺序，逐一分配到 web 层服务，然后周而复始。如果 web 层服务 down 掉，自动剔除</li> <li>ip 哈希。按照 ip 的哈希值，确定路由到对应的 web 层。只要是用户的 ip 是均匀的，那么请求到 Web 层也是均匀的。</li></ul> <p>还有个好处就是同一个 ip 的请求会分发到相同的 web 层服务。这样每个用户固定访问一个 web 层服务，可以解决 session 的问题。</p> <p><strong>第 3 层：Web 层 -&gt; 业务服务层 的负载均衡</strong></p> <p>Web 层 -&gt; 业务服务层 的负载均衡如何实现呢？</p> <p>比如 Dubbo 是一个服务治理方案，包括服务注册、服务降级、访问控制、动态配置路由规则、权重调节、负载均衡。其中一个特性就是智能负载均衡：内置多种负载均衡策略，智能感知下游节点健康状况，显著减少调用延迟，提高系统吞吐量。</p> <p>为了避免避免单点故障和支持服务的横向扩容，一个服务通常会部署多个实例，即 Dubbo 集群部署。会将多个服务实例成为一个服务提供方，然后根据配置的随机负载均衡策略，在20个 Provider 中随机选择了一个来调用，假设随机到了第7个 Provider。LoadBalance 组件从提供者地址列表中，使用均衡策略，选择选一个提供者进行调用，如果调用失败，再选另一台调用。</p> <p>Dubbo内置了4种负载均衡策略:</p> <ul><li>RandomLoadBalance:随机负载均衡。随机的选择一个。是Dubbo的默认负载均衡策略。</li> <li>RoundRobinLoadBalance:轮询负载均衡。轮询选择一个。</li> <li>LeastActiveLoadBalance:最少活跃调用数，相同活跃数的随机。活跃数指调用前后计数差。使慢的 Provider 收到更少请求，因为越慢的 Provider 的调用前后计数差会越大。</li> <li>ConsistentHashLoadBalance:一致性哈希负载均衡。相同参数的请求总是落在同一台机器上。</li></ul> <p>同样，因为业务的需要，也可以实现自己的负载均衡策略</p> <p><strong>第 4 层：业务服务层 -&gt; 数据存储层 的负载均衡</strong></p> <p>数据存储层的负载均衡，一般通过 DBProxy 实现。比如 MySQL 分库分表。</p> <p>当单库或者单表访问太大，数据量太大的情况下，需要进行垂直拆分和水平拆分两个维度。比如水平切分规则：</p> <ul><li>Range 、 时间</li> <li>hash 取模，订单根据店铺ID 等</li></ul> <p>但伴随着这块的负载会出现下面的问题，需要解决：</p> <ul><li>分布式事务</li> <li>跨库 join 等</li></ul> <p>现状分库分表的产品方案很多：当当 sharding-jdbc、阿里的 Cobar 等</p> <p><strong>所以：</strong></p> <p>对外看来，负载均衡是一个系统或软件的整体。对内看来，层层上下游调用。只要存在调用，就需要考虑负载均衡这个因素。所以负载均衡（Load Balance）是分布式系统架构设计中必须考虑的因素之一。考虑主要是如何让下游接收到的请求是均匀分布的：</p> <ul><li>第 1 层：客户端层 -&gt; 反向代理层 的负载均衡。通过 DNS 轮询</li> <li>第 2 层：反向代理层 -&gt; Web 层 的负载均衡。通过 Nginx 的负载均衡模块</li> <li>第 3 层：Web 层 -&gt; 业务服务层 的负载均衡。通过服务治理框架的负载均衡模块</li> <li>第 4 层：业务服务层 -&gt; 数据存储层 的负载均衡。通过数据的水平分布，数据均匀了，理论上请求也会均匀。比如通过买家ID分片类似</li></ul> <br> <h2 id="服务端、客户端负载均衡"><a href="#服务端、客户端负载均衡" class="header-anchor">#</a> <strong>服务端、客户端负载均衡</strong></h2> <h3 id="服务端负载均衡"><a href="#服务端负载均衡" class="header-anchor">#</a> <strong>服务端负载均衡</strong></h3> <p>负载均衡是我们处理高并发、缓解网络压力和进行服务端扩容的重要手段之一，但是一般情况下我们所说的负载均衡通常都是指服务端负载均衡，服务端负载均衡又分为两种，一种是硬件负载均衡，还有一种是软件负载均衡。<br>硬件负载均衡主要通过在服务器节点之间安装专门用于负载均衡的设备，常见的如F5。<br>软件负载均衡则主要是在服务器上安装一些具有负载均衡功能的软件来完成请求分发进而实现负载均衡，常见的就是Nginx。<br>无论是硬件负载均衡还是软件负载均衡，它的工作原理都不外乎下面这张图：</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <p>无论是硬件负载均衡还是软件负载均衡都会维护一个可用的服务端清单，然后通过心跳机制来删除故障的服务端节点以保证清单中都是可以正常访问的服务端节点，此时当客户端的请求到达负载均衡服务器时，负载均衡服务器按照某种配置好的规则从可用服务端清单中选出一台服务器去处理客户端的请求。这就是服务端负载均衡。</p> <h3 id="客户端负载均衡"><a href="#客户端负载均衡" class="header-anchor">#</a> <strong>客户端负载均衡</strong></h3> <p>我们在Spring Cloud中服务的发现与消费一文中涉及到了客户端负载均衡，在那篇文章中我们提到</p> <p>“Ribbo是一个基于HTTP和TCP的客户端负载均衡器，当我们将Ribbon和Eureka一起使用时，Ribbon会从Eureka注册中心去获取服务端列表，然后进行轮询访问以到达负载均衡的作用，客户端负载均衡中也需要心跳机制去维护服务端清单的有效性，当然这个过程需要配合服务注册中心一起完成。”</p> <p>从上面的描述我们可以看出，客户端负载均衡和服务端负载均衡最大的区别在于服务清单所存储的位置。在客户端负载均衡中，所有的客户端节点都有一份自己要访问的服务端清单，这些清单统统都是从Eureka服务注册中心获取的。在Spring Cloud中我们如果想要使用客户端负载均衡，方法很简单，开启@LoadBalanced注解即可，这样客户端在发起请求的时候会先自行选择一个服务端，向该服务端发起请求，从而实现负载均衡。具体小伙伴们可以参考Spring Cloud中服务的发现与消费这篇文章。</p> <br> <h2 id="负载均衡分类-（分布式架构下的负载均衡）"><a href="#负载均衡分类-（分布式架构下的负载均衡）" class="header-anchor">#</a> <strong>负载均衡分类 （分布式架构下的负载均衡）</strong></h2> <p>负载均衡可以根据网络协议的层数进行分类，我们这里以ISO模型为准，从下到上分为：<br>物理层，数据链路层，网络层，传输层，会话层，表示层，应用层。</p> <p>当客户端发起请求，会经过层层的封装，发给服务器，服务器收到请求后经过层层的解析，获取到对应的内容。</p> <div style="display:flex;"><img src="/assets/img/lb-5.0e3c5025.png" alt="" align="left" style="zoom:120%;display:block;"></div> <h3 id="二层负载均衡"><a href="#二层负载均衡" class="header-anchor">#</a> <strong>二层负载均衡</strong></h3> <p>二层负债均衡是基于数据链路层的负债均衡，即让负债均衡服务器和业务服务器绑定同一个虚拟IP（即VIP），客户端直接通过这个VIP进行请求，那么如何区分相同IP下的不同机器呢？没错，通过MAC物理地址，每台机器的MAC物理地址都不一样，当负载均衡服务器接收到请求之后，通过改写HTTP报文中以太网首部的MAC地址，按照某种算法将请求转发到目标机器上，实现负载均衡。</p> <p>这种方式负载方式虽然控制粒度比较粗，但是优点是负载均衡服务器的压力会比较小，负载均衡服务器只负责请求的进入，不负责请求的响应（响应是有后端业务服务器直接响应给客户端），吞吐量会比较高。</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <h3 id="三层负载均衡"><a href="#三层负载均衡" class="header-anchor">#</a> <strong>三层负载均衡</strong></h3> <p>三层负载均衡是基于网络层的负载均衡，通俗的说就是按照不同机器不同IP地址进行转发请求到不同的机器上。</p> <p>这种方式虽然比二层负载多了一层，但从控制的颗粒度上看，并没有比二层负载均衡更有优势，并且，由于请求的进出都要经过负载均衡服务器，会对其造成比较大的压力，性能也比二层负载均衡要差。</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <h3 id="四层负载均衡"><a href="#四层负载均衡" class="header-anchor">#</a> <strong>四层负载均衡</strong></h3> <p>四层负载均衡是基于传输层的负载均衡，传输层的代表协议就是TCP/UDP协议，除了包含IP之外，还有区分了端口号，通俗的说就是基于IP+端口号进行请求的转发。相对于上面两种，控制力度缩小到了端口，可以针对同一机器上的不用服务进行负载。</p> <p>这一层以LVS为代表。</p> <h3 id="七层负载均衡"><a href="#七层负载均衡" class="header-anchor">#</a> <strong>七层负载均衡</strong></h3> <p>七层负载均衡是基于应用层的负载均衡，应用层的代表协议有HTTP，DNS等，可以根据请求的url进行转发负载，比起四层负载，会更加的灵活，所控制到的粒度也是最细的，使得整个网络更&quot;智能化&quot;。例如访问一个网站的用户流量，可以通过七层的方式，将对图片类的请求转发到特定的图片服务器并可以使用缓存技术；将对文字类的请求可以转发到特定的文字服务器并可以使用压缩技术。可以说功能是非常强大的负载。</p> <p>这一层以Nginx为代表。</p> <h3 id="实践应用"><a href="#实践应用" class="header-anchor">#</a> 实践应用</h3> <p>在普通的应用架构中，使用Nginx完全可以满足需求，对于一些大型应用，一般会采用DNS+LVS+Nginx的方式进行多层次负载均衡，以上这些说明都是基于软件层面的负载均衡，在一些超大型的应用中，还会在前面多加一层物理负载均衡，比如知名的F5。</p> <br> <h2 id="负载均衡算法"><a href="#负载均衡算法" class="header-anchor">#</a> <strong>负载均衡算法</strong></h2> <p>负载均衡算法分为两类：一种是静态负载均衡，一种是动态负载均衡。</p> <h3 id="静态均衡算法"><a href="#静态均衡算法" class="header-anchor">#</a> <strong>静态均衡算法</strong></h3> <p><strong>1、轮询法</strong></p> <p>将请求按顺序轮流地分配到每个节点上，不关心每个节点实际的连接数和当前的系统负载。</p> <ul><li>优点：简单高效，易于水平扩展，每个节点满足字面意义上的均衡；</li> <li>缺点：没有考虑机器的性能问题，根据木桶最短木板理论，集群性能瓶颈更多的会受性能差的服务器影响。</li></ul> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <p><strong>2、随机法</strong></p> <p>将请求随机分配到各个节点。由概率统计理论得知，随着客户端调用服务端的次数增多，其实际效果越来越接近于平均分配，也就是轮询的结果。</p> <p>优缺点和轮询相似。</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <p><strong>3、源地址哈希法</strong></p> <p>源地址哈希的思想是根据客户端的IP地址，通过哈希函数计算得到一个数值，用该数值对服务器节点数进行取模，得到的结果便是要访问节点序号。采用源地址哈希法进行负载均衡，同一IP地址的客户端，当后端服务器列表不变时，它每次都会落到到同一台服务器进行访问。</p> <ul><li>优点：相同的IP每次落在同一个节点，可以人为干预客户端请求方向，例如灰度发布；</li> <li>缺点：如果某个节点出现故障，会导致这个节点上的客户端无法使用，无法保证高可用。当某一用户成为热点用户，那么会有巨大的流量涌向这个节点，导致冷热分布不均衡，无法有效利用起集群的性能。所以当热点事件出现时，一般会将源地址哈希法切换成轮询法。</li></ul> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <p><strong>4、加权轮询法</strong></p> <p>不同的后端服务器可能机器的配置和当前系统的负载并不相同，因此它们的抗压能力也不相同。给配置高、负载低的机器配置更高的权重，让其处理更多的请；而配置低、负载高的机器，给其分配较低的权重，降低其系统负载，加权轮询能很好地处理这一问题，并将请求顺序且按照权重分配到后端。</p> <p>加权轮询算法要生成一个服务器序列，该序列中包含n个服务器。n是所有服务器的权重之和。在该序列中，每个服务器的出现的次数，等于其权重值。并且，生成的序列中，服务器的分布应该尽可能的均匀。比如序列{a, a, a, a, a, b, c}中，前五个请求都会分配给服务器a，这就是一种不均匀的分配方法，更好的序列应该是：{a, a, b, a, c, a, a}。</p> <ul><li>优点：可以将不同机器的性能问题纳入到考量范围，集群性能最优最大化；</li> <li>缺点：生产环境复杂多变，服务器抗压能力也无法精确估算，静态算法导致无法实时动态调整节点权重，只能粗糙优化。</li></ul> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <p><strong>5、加权随机法</strong></p> <p>与加权轮询法一样，加权随机法也根据后端机器的配置，系统的负载分配不同的权重。不同的是，它是按照权重随机请求后端服务器，而非顺序。</p> <p><strong>6、键值范围法</strong></p> <p>根据键的范围进行负债，比如0到10万的用户请求走第一个节点服务器，10万到20万的用户请求走第二个节点服务器……以此类推。</p> <ul><li>优点：容易水平扩展，随着用户量增加，可以增加节点而不影响旧数据；</li> <li>缺点：容易负债不均衡，比如新注册的用户活跃度高，旧用户活跃度低，那么压力就全在新增的服务节点上，旧服务节点性能浪费。而且也容易单点故障，无法满足高可用。</li></ul> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <p>（注：以上所提到的单点故障，都可以用主从方式来解决，从节点监听主节点心跳，当发现主节点死亡，从节点切换成主节点顶替上去。这里可以思考一个问题，怎么设计集群主从可以最大程度上降低成本）</p> <h3 id="动态负债均衡算法"><a href="#动态负债均衡算法" class="header-anchor">#</a> <strong>动态负债均衡算法</strong></h3> <p><strong>1、最小连接数法</strong></p> <p>根据每个节点当前的连接情况，动态地选取其中当前积压连接数最少的一个节点处理当前请求，尽可能地提高后端服务的利用效率，将请求合理地分流到每一台服务器。俗称闲的人不能闲着，大家一起动起来。</p> <ul><li>优点：动态，根据节点状况实时变化；</li> <li>缺点：提高了复杂度，每次连接断开需要进行计数；</li></ul> <p>实现：将连接数的倒数当权重值。</p> <p><strong>2、最快响应速度法</strong></p> <p>根据请求的响应时间，来动态调整每个节点的权重，将响应速度快的服务节点分配更多的请求，响应速度慢的服务节点分配更少的请求，俗称能者多劳，扶贫救弱。</p> <ul><li>优点：动态，实时变化，控制的粒度更细，跟灵敏；</li> <li>缺点：复杂度更高，每次需要计算请求的响应速度；</li></ul> <p>实现：可以根据响应时间进行打分，计算权重。</p> <p><strong>3、观察模式法</strong></p> <p>观察者模式是综合了最小连接数和最快响应度，同时考量这两个指标数，进行一个权重的分配。</p> <br> <h2 id="网站负载均衡技术-一些手段"><a href="#网站负载均衡技术-一些手段" class="header-anchor">#</a> <strong>网站负载均衡技术-一些手段</strong></h2> <p>负载均衡的实现方式多种多样，从硬件到软件，从商业产品到开源产品，应有尽有。但是，实现负载均衡的基础技术不外乎以下几种：</p> <h3 id="_1-http重定向负载均衡"><a href="#_1-http重定向负载均衡" class="header-anchor">#</a> (1) HTTP重定向负载均衡</h3> <p>评价：★★</p> <div style="display:flex;"><img src="data:image/png;base64,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PJmDJGte0izmOuNCOBX6ANV+b/7MaKoqhJiNVROiia0MhfI0jpHXuXAHwNr+dl+krprx/h9NY/0xvW8S6nK9RERpGl3SLkHolVus3I70KUu6Rcg9Eqt1m5HehQWREQEREBERAREQEREBERAREQEREBERAREQEREBERAUKvdZOVXUKvdZOVBdERAREQEREBERAREQEREEH71D5O+yuoP3qHyd9ldBhz1nVxMejLuia12h/ECSPpZVjnEk0seUgR2179v8JJSwS588Yd0gDXXvqBsC+ugjMvSZe1prc8L29Sg11VVUznvFRRslMJdcuAd2WhpJGn+oaLKp521LXNfGGABpAJBBBFx//FQ0kBc5xiaXOfnJ73WAv9B8kbSU7CC2JoLXZhYbDa3ogx6rEGUkoY6Mm7S7Twvp3cOJHhdXjqHyQOcI/wCoxxaW30zDx7l9vp4pHEvjDjaxuNo8e/aV42lga1zGxjK4WI79b/dB7TTdYp2y5S3MNh4Ky+I2NjaGsaGgcAvtBGl3SLkHolVus3I70KUu6Rcg9Eqt1m5HehQWREQEREBERAREQEREBERAREQEREBERAREQEREBERAUKvdZOVXUKvdZOVBdERAREQEREBERAREQEREEH71D5O+yuoP3qHyd9ldAREQEREBERAREQRpd0i5B6JVbrNyO9ClLukXIPRKrdZuR3oUFkREBERAREQEREBERAREQEREBERAREQEREBERAREQFCr3WTlV1Cr3WTlQXREQEREBERAREQEREBERBCTe4fJ3oFdRkhbKQXZgW3sWuIP0TqzPel/yu/lBZFHqzPel/yu/lOrM96X/K7+UFkUerM96X/K7+U6sz3pf8rv5QWRR6sz3pf8rv5TqzPel/yu/lBZFHqzPel/yu/lOrM96X/K7+UCl3SLkHolVus3I70K+42CNgY3RrRYDwXxVbrNyO9CgsiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAoVe6ycqusXEv8A8bU/9N3ogyUXKog6pFyqIOqRcqiDqkXKog6pFyqIOqRcqiDqkXKog6pFyqIOqRcqiDqkXKog6pFyqIOqUqrdZuR3oVzSnPu8vI70KD//2Q==" alt="" align="left" style="zoom:120%;display:block;"></div> <p>此方案的优点是<strong>简单易行</strong>，缺点是：</p> <ul><li>①浏览器需要两次请求才能完成一次访问，<strong>性能较差</strong>；</li> <li>②重定向服务器自身的处理能力有可能成为瓶颈，整个集群的<strong>伸缩性规模有限</strong>；</li> <li>③使用HTTP 302重定向有可能使搜索引擎判断为<strong>SEO作弊</strong>，降低搜索排名；</li></ul> <h3 id="_2-dns域名解析负载均衡"><a href="#_2-dns域名解析负载均衡" class="header-anchor">#</a> (2) DNS域名解析负载均衡</h3> <p>评价：★★★</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <p>此方案要求在DNS服务器中配置多个A记录，例如：</p> <table><thead><tr><th>www.mysite.com IN A</th> <th>114.100.80.1</th></tr></thead> <tbody><tr><td>www.mysite.com IN A</td> <td>114.100.80.2</td></tr> <tr><td>www.mysite.com IN A</td> <td>114.100.80.3</td></tr></tbody></table> <p>此方案的优点是将负载均衡的工作转交给了DNS，省掉了网站管理维护负载均衡服务器的麻烦。而缺点是：</p> <ul><li>①目前的DNS是<strong>多级解析</strong>，每一级DNS都可能缓存A记录，当某台服务器下线后，即使修改了DNS的A记录，要使其生效仍然需要较长时间。这段期间，会导致用户访问已经下线的服务器造成访问失败。</li> <li>②DNS负载均衡的控制权在域名服务商那里，网站无法对其做更多改善和管理；</li></ul> <blockquote><p>**TIPS：**事实上，大型网站总是部分使用DNS域名解析，利用域名解析作为第一级负载均很手段，即域名解析得到的一组服务器不是实际的Web服务器，而是同样提供负载均衡的内部服务器，这组内部服务器再进行负载均衡，请求分发到真实的Web服务器上。</p></blockquote> <h3 id="_3-反向代理负载均衡"><a href="#_3-反向代理负载均衡" class="header-anchor">#</a> (3) 反向代理负载均衡</h3> <p>评价：★★★★</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <p>Web服务器不需要使用外部IP地址，而反向代理服务器则需要配置双网卡和内外部两套IP地址。</p> <p>此方案的优点是<strong>和反向代理服务器功能集成在一起，部署简单</strong>。缺点是<strong>反向代理服务器是所有请求和响应的中转站，其性能可能会成为瓶颈</strong>。</p> <h3 id="_4-ip负载均衡"><a href="#_4-ip负载均衡" class="header-anchor">#</a> (4) IP负载均衡</h3> <p>评价：★★★★</p> <div style="display:flex;"><img src="/assets/img/lb-16.1919c302.png" alt="" align="left" style="zoom:120%;display:block;"></div> <p>此方案优点在于在<strong>内核进程</strong>完成数据分发，较反向代理负载均衡（在应用程序中分发数据）有更好的处理性能。缺点是由于所有请求响应都需要经过负载均衡服务器，集群的最大响应数据吞吐量不得不<strong>受制于负载均衡服务器网卡带宽</strong>。</p> <h3 id="_5-数据链路层负载均衡"><a href="#_5-数据链路层负载均衡" class="header-anchor">#</a> (5) 数据链路层负载均衡</h3> <p>评价：★★★★★</p> <div style="display:flex;"><img src="/assets/img/lb-17.833b9b75.png" alt="" align="left" style="zoom:120%;display:block;"></div> <p>此种方式又称作<strong>三角传输模式</strong>，负载均衡数据分发过程中不修改IP地址，只修改mac地址，由于实际处理请求的真实物理IP地址和数据请求目的IP地址一致，所以不需要通过负载均衡服务器进行地址转换，可将响应数据包直接返回给用户浏览器，避免负载均衡服务器网卡带宽成为瓶颈。这种负载均衡方式又称作<strong>直接路由方式（DR）</strong>。</p> <p><strong>使用三角传输模式的链路层负载均衡是目前大型网站使用最广泛的一种负载均衡手段</strong>。在Linux平台上最好的链路层负载均衡开源产品是LVS（Linux Virutal Server）。</p> <h3 id="lvs负载均衡机制"><a href="#lvs负载均衡机制" class="header-anchor">#</a> <strong>LVS负载均衡机制</strong></h3> <ol><li><p>LVS是<strong>四层</strong>负载均衡，也就是说建立在OSI模型的第四层——传输层之上，传输层上有我们熟悉的TCP/UDP，LVS支持TCP/UDP的负载均衡。因为LVS是四层负载均衡，因此它相对于其它高层负载均衡的解决办法，比如DNS域名轮流解析、应用层负载的调度、客户端的调度等，它的效率是非常高的。</p></li> <li><p>LVS的转发主要通过<strong>修改IP地址</strong>（NAT模式，分为源地址修改SNAT和目标地址修改DNAT）、<strong>修改目标MAC</strong>（DR模式）来实现</p> <ul><li><p><strong>NAT模式：网络地址转换</strong></p> <div style="display:flex;"><img src="/assets/img/lb-18.1919c302.png" alt="" align="left" style="zoom:120%;display:block;"></div> <ul><li>NAT（Network Address Translation）是一种<strong>外网和内网地址映射</strong>的技术。NAT模式下，网络数据报的进出都要经过LVS的处理。LVS需要作为RS（真实服务器）的网关。当包到达LVS时，LVS做目标地址转换（DNAT），将目标IP改为RS的IP。RS接收到包以后，仿佛是客户端直接发给它的一样。RS处理完，返回响应时，源IP是RS IP，目标IP是客户端的IP。这时RS的包通过网关（LVS）中转，LVS会做源地址转换（SNAT），将包的源地址改为VIP，这样，这个包对客户端看起来就仿佛是LVS直接返回给它的。客户端无法感知到后端RS的存在。</li></ul></li> <li><p><strong>DR模式：直接路由</strong></p> <div style="display:flex;"><img src="/assets/img/lb-19.6328d302.png" alt="" align="left" style="zoom:120%;display:block;"></div> <ul><li>DR模式下需要LVS和RS集群绑定同一个VIP（RS通过将VIP绑定在loopback实现），但与NAT的不同点在于：请求由LVS接受，由真实提供服务的服务器（RealServer, RS）直接返回给用户，返回的时候不经过LVS。详细来看，一个请求过来时，LVS只需要将网络帧的MAC地址修改为某一台RS的MAC，该包就会被转发到相应的RS处理，注意此时的源IP和目标IP都没变，LVS只是做了一下移花接木。RS收到LVS转发来的包时，链路层发现MAC是自己的，到上面的网络层，发现IP也是自己的，于是这个包被合法地接受，RS感知不到前面有LVS的存在。而当RS返回响应时，只要直接向源IP（即用户的IP）返回即可，不再经过LVS。</li></ul></li></ul></li> <li><p><strong>DR</strong>负载均衡模式数据分发过程中不修改IP地址，只修改mac地址，由于实际处理请求的真实物理IP地址和数据请求目的IP地址一致，所以不需要通过负载均衡服务器进行地址转换，可将响应数据包直接返回给用户浏览器，避免负载均衡服务器网卡带宽成为瓶颈。因此，DR模式具有较好的性能，也是目前大型网站<strong>使用最广泛</strong>的一种负载均衡手段。</p></li></ol> <br> <h2 id="负载方案构想"><a href="#负载方案构想" class="header-anchor">#</a> <strong>负载方案构想</strong></h2> <h3 id="方案一：独立的nginx-haproxy方案"><a href="#方案一：独立的nginx-haproxy方案" class="header-anchor">#</a> <strong>方案一：独立的Nginx/Haproxy方案</strong></h3> <p>很显然，第一个业务场景下，系统并没有多大的压力就是一套简单业务系统，日访问量也完全没有“有访问压力”这样的说法。但是客户有一个要求值得我们关注：要保证系统以后的功能和性能扩展性。为了保证功能和性能扩展性，在系统建立之初就要有一个很好的业务拆分规划，例如我们首先会把用户信息权限子系统和订单系统进行拆分，独立的车辆信息和定位系统可能也需要拆分出来。</p> <p>这也是我们在系统建立时就要引入负载均衡层的一个重要原因。也是负载均衡层的重要作用之一。如下图所示：</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <p>可以看出，这时负载均衡层只有一个作用，<strong>就是按照设定的访问规则，将访问不同系统的请求转发给对应的系统，并且在出现错误访问的情况下转发到错误提示页面</strong>。</p> <h3 id="方案二：nginx-haproxy-keepalived-heartbeat方案"><a href="#方案二：nginx-haproxy-keepalived-heartbeat方案" class="header-anchor">#</a> <strong>方案二：Nginx/Haproxy + Keepalived/Heartbeat方案</strong></h3> <p>此后，系统的访问压力进一步加大，系统的稳定性越来越受到我们的关注。所以在单节点处理还能满足业务要求的情况下，我们为负载层（还有各层）引入热备方案，以保证一个节点在崩溃的情况下，另一个节点能够自动接替其工作，为工程师解决问题赢得时间。如下图所示：</p> <div style="display:flex;"><img src="/assets/img/lb-21.43247d23.png" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <h3 id="方案三：lvs-dr-keepalived-heartbeat-nginx-haproxy方案"><a href="#方案三：lvs-dr-keepalived-heartbeat-nginx-haproxy方案" class="header-anchor">#</a> <strong>方案三：LVS(DR) + Keepalived/Heartbeat + Nginx/Haproxy方案</strong></h3> <p>在第三版本架构方案中，为了保证负载层足够稳定的状态下，适应更大的访问吞吐量还要应付可能的访问洪峰，我们加入了LVS技术。LVS负责第一层负载，然后再将访问请求转发到后端的若干台Nginx上。LVS的DR工作模式，只是将请求转到后端，<strong>后端的Nginx服务器必须有一个外网IP，在收到请求并处理完成后，Nginx将直接发送结果到请求方，不会再经LVS回发</strong>（具体的LVS工作原理介绍将在后文中详细介绍）。</p> <div style="display:flex;"><img src="/assets/img/lb-22.e5eb667c.png" alt="" align="left" style="zoom:120%;display:block;"></div> <p>这里要注意的是：</p> <ul><li>有了上层的LVS的支撑Nginx就不再需要使用Keepalived作为热备方案。因为首先Nginx不再是单个节点进行负载处理，而是一个集群多台Nginx节点；另外LVS对于下后端的服务器自带基于端口的健康检查功能；</li> <li>LVS是单节点处理的，虽然LVS是非常稳定的，但是为了保证LVS更稳定的工作，我们还是需要使用Keepalived为 LVS做一个热备节点，以防不时之需。</li></ul> <h3 id="方案四：dns轮询-智能dns-lvs-dr-keepalived-nginx方案"><a href="#方案四：dns轮询-智能dns-lvs-dr-keepalived-nginx方案" class="header-anchor">#</a> <strong>方案四：DNS轮询/智能DNS + LVS(DR) + Keepalived + Nginx方案</strong></h3> <div style="display:flex;"><img src="/assets/img/lb-23.12a7bf40.png" alt="" align="left" style="zoom:120%;display:block;"></div> <p>场景四中，为了满足平均上亿的日PV访问，在对业务进行外网暴露的基础上，我们在互联网的最前端做了一个DNS轮询。然后将（对用户信息系统）访问压力首先分摊到两个对称LVS组上，再由每个组向下继续分拆访问压力。</p> <p>注意上图的负载层方案的不同：</p> <ul><li>首先我们不在像前面的方案中，使用目录名分割业务系统了，而是直接将业务系统的访问使用不同的二级域名 (这里是 xxx.<strong>user</strong>.com)进行拆分。这样的变化有利于每个业务系统都拥有自己独立的负载均衡层。</li> <li>请注意上图中的细节，<strong>这个负载均衡层是专门为“用户信息子系统”提供负载均衡支撑的</strong>，而可能还存在的“订单子系统”、“车辆信息子系统”都会有他们独立的负载均衡层。</li> <li>在LVS下方的Nginx服务可以实现无限制的扩展，同样的就像场景三种所给出的解决方案一样，Nginx本身不在需要Keepalived保持热备，而是全部交由上层的LVS进行健康情况检查。而即使有一两台Nginx服务器出现故障，对整个负载集群来说问题也不大。</li></ul> <blockquote><p>方案扩展到了这一步，LVS层就没有必要再进行扩展新的节点了。为什么呢？根据您的业务选择的合适的LVS工作模式，两个LVS节点的性能足以支撑地球上的所有核心WEB站点。如果您对LVS的性能有疑惑，请自行谷歌百度。</p></blockquote> <h3 id="为什么没有独立的lvs方案"><a href="#为什么没有独立的lvs方案" class="header-anchor">#</a> <strong>为什么没有独立的LVS方案</strong></h3> <p>如果用一句话说明其中的原因，那就是LVS为了保证其性能对配置性有所牺牲，单独使用的话往往无法满足业务层对负载层灵活分配请求的要求。</p> <h3 id="术语说明"><a href="#术语说明" class="header-anchor">#</a> <strong>术语说明</strong></h3> <ul><li><strong>TPS</strong>: 衡量业务层处理性能的重要指标（每秒钟request/事务的处理数量）。业务服务处理一个完整的业务过程，并向上层返回处理结果的过程就是一个 request/事务。那么在一秒钟内整个业务系统能够完成多少个这样的过程，其衡量单位就是TPS。TPS不但和系统架构有很大的关系（特别是业务层和业务通信层的架构祥泰），和物理环境、代码质量的关系也非常密切。</li> <li><strong>PV</strong>: 网页浏览数是评价网站流量最常用的指标之一，简称为PV。Page Views中的Page一般是指普通的html网页，也包含php、jsp等动态产生的html内容。注意是完整的显示一个Page成为一个PV。但是一个PV，一般需要多次HTTP请求，以便获取多个静态资源，这是需要注意的。</li> <li><strong>UV</strong>: Unique Visitor 一个独立IP，在一个单位时间内（例如一日/一小时）对系统的一个PV请求，成为一个UV（重复的PV不在进行计数）。</li> <li><strong>RUV</strong>: Repeat User Visitor 一个独立用户，在一个单位时间内（例如一日/一小时）对系统的一个PV请求，并且重复的访问要进行计数。</li></ul> <h3 id="硬件负载"><a href="#硬件负载" class="header-anchor">#</a> <strong>硬件负载</strong></h3> <p>目前我们所提到的诸如Nginx、LVS等技术，没有详细讲述的Haproxy、Squid等技术，都是基于软件的负载技术。F5是一家公司，它的BIG-IP LTM技术是基于硬件负载的。硬件负载方案提供了软件负载技术无法提供了性能空间，并且集成了NAT映射功能、SSL加速、Cookie加密、高速缓存、攻击过滤、包过滤、动态Session保持等等很多软件负载无法提供的功能（或者需要多个软件组合使用才能提供的功能）。</p> <p>但是硬件负载方案也有其缺点，主要就是建设费用比较高昂，它不像软负载可以根据系统的吞吐量的持续增加进行持续扩展。当然您可以根据系统的吞吐量需求，在前期采用软负载，后期采用硬件负载的方案。除了F5公司提供的硬件负载技术，还有Citrix公司的硬负载方案、A10公司的硬件负载方案。</p> <div style="display:flex;"><img src="data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/+EAjEV4aWYAAE1NACoAAAAIAAUBEgADAAAAAQABAAABGgAFAAAAAQAAAEoBGwAFAAAAAQAAAFIBKAADAAAAAQACAACHaQAEAAAAAQAAAFoAAAAAAAAAYAAAAAEAAABgAAAAAQADoAEAAwAAAAEAAQAAoAIABAAAAAEAAAE/oAMABAAAAAEAAAEiAAAAAP/bAEMACgcHCAcGCggICAsKCgsOGBAODQ0OHRUWERgjHyUkIh8iISYrNy8mKTQpISIwQTE0OTs+Pj4lLkRJQzxINz0+O//bAEMBCgsLDg0OHBAQHDsoIig7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O//AABEIASIBPwMBIgACEQEDEQH/xAAcAAEAAQUBAQAAAAAAAAAAAAAABAECAwUGBwj/xABMEAABAwIDBQMGCwYCCAcAAAABAAIDBBEFEiEGEzFBUSJhcQcUMkKBkRUWIzVScqGxssHRNFZiktLwM0MkZHOCk6Kz0yZFVGPh4vH/xAAZAQEBAQEBAQAAAAAAAAAAAAAAAgEDBAX/xAAjEQEBAAIDAAICAgMAAAAAAAAAAQIREiExA0EEIhNhFEJR/9oADAMBAAIRAxEAPwD2ZERAREQEREBERAREQEREGKWVkETpZHBrGi5JWgq8Rqqn5UTS09LewZCz5R3e5xvYeA9q023+0Rw7HMEw0zGGmle+aqd/CBlaD3Zjc+C20ddSUsbN/URR5x2Q5wu7wHNevD4LMJnZ645/JJdLqinhhhbVZqtjzY521clvaL2+xav4+DDcTbFiIBoJCG+cX7UJ6u5FveLEd41GoxPaSSre5zTkj1DWj6PeuQxOWSvlbTMs58rwxoJsLk2F19D4fwpnP3eb/Kx3qPfGuDmhzSCCLgjmrlz+xcUlHs7T4dNMZn0bRFnItcAaAdw4DnYBdAvjZ48cri92N3NqoqIpaqioiCqKiIKoiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiDyPytMZ8ZcNkD2lxpXtc0HVtnAi/jc+5arD6p1RTQ008bZhE3dwv1EkYJBAB5i/IjgsW2sklTtXiD5XEkSWYegAsPzWDB6qEuAL7OaeR1BX3/wvmwz+D+O+x8n83HKXl9OixLZjE6OB072Mlja27nRH0QOZH6LlahxikEkTsr2ODmubxaRqCvVcExkV9JIJ3ML4bZnD1hbiftXnu2eL0mI4rlpMobG0szADtG+p04jounwfk3C2fLOo80+LG6uF9d75NsXnxjDKyapMIlZOGZYwQbBo1I7zddjI8RxOeSAGtJueAXknkufJDtK+JjiI5ICHjrbUfmvXS0OBBAIPIr4PzZzP5LlPH3MJrGRqaDEKipFO57xZwbmGSxN83XwCrNiNS2qdHGxxyucGgRZg6wGpN+p5KY3D4WsDWl4sQQQ43FhYDw1PvVrsNgeHh+Z2a41N8tzc28VO8ds1lr1bJUyucxmsWZti7J6xGlr9NSVgqa+eOON2UxnKc4sONwBYnlcqbJRxSSskcX3Y0tAa8gW8B4KjKCBhhs0kQtLWBxva/isljdZI+H1ctTJOHv7LBYEgXBBIPDTiFkoKt1RA7P6bOdrZ2+q63eFe7D6d2YZCGuDWljTYEDgLDksjqaJ0zJS2z2AtBBtoeR6hLYSWIzaqp83gnc6IiUsBaGEWzd91PUVuHwNZGwGS0ZBaDK4jThzUoLK2b+1URFihERAREQEREBERAREQEREBERAREQEREBERAREQEREHle3mzzocTkqzljhndmimdowOPGN55a6g95C4apwrzd9545Kd54OOgPg7gfYV9EVFPDVwPgqImSxPFnMeLghaNuyFBTRPiovkonXtG+7mt8NVUys8ZcZfXikYfHG9oxGcMkaWPAksHN6HuV9PhO9vLTxksGrpnuysHeXHT7z3L02k2NrDi02bE6d8URGaLzMNOouO0t8dksMnmjlrIhUbvVkbh2AetuftW3PK+1Mwxnkc95O8BNO52JEHc5S2J5Ft848XAcmgaDrcld+rWtDWhrQABoAOSuULEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQQKP50xD60f4Ap3NQaP50xD60f4Ap3NbfWYqoiLGiIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiIIFH86Yh9aP8AU7moNH86Yh9aP8AU7mqy9TiqiIpUIiICIiAiI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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <h2 id="nginx-keepalived-lvs-f5-架构设计"><a href="#nginx-keepalived-lvs-f5-架构设计" class="header-anchor">#</a> <strong>nginx/keepalived/lvs/f5 架构设计</strong></h2> <p><strong>nginx、keepalived、lvs、f5可以很好的解决高可用、扩展性、反向代理+扩展均衡的问题</strong></p> <h3 id="单机"><a href="#单机" class="header-anchor">#</a> <strong>单机</strong></h3> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <ul><li>浏览器通过DNS-server，域名解析到ip</li> <li>浏览器通过ip访问web-server</li></ul> <p>缺点：</p> <ul><li>1）非高可用，web-server挂了整个系统就挂了</li> <li>2）扩展性差，当吞吐量达到web-server上限时，无法扩容</li></ul> <h3 id="dns轮询"><a href="#dns轮询" class="header-anchor">#</a> <strong>DNS轮询</strong></h3> <p>DNS轮询：通过在DNS-server上对一个域名设置多个ip解析，来扩充web-server性能及实施负载均衡的技术</p> <div style="display:flex;"><img src="data:image/png;base64,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" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <ul><li>多部署几份web-server，1个tomcat抗1000，部署3个tomcat就能抗3000</li> <li>在DNS-server层面，域名每次解析到不同的ip</li></ul> <p>优点：</p> <ul><li>1）零成本：在DNS-server上多配几个ip即可，功能也不收费</li> <li>2）部署简单：多部署几个web-server即可，原系统架构不需要做任何改造</li> <li>3）负载均衡：变成了多机，但负载基本是均衡的</li></ul> <p>缺点：</p> <ul><li>1）非高可用：DNS-server只负责域名解析ip，这个ip对应的服务是否可用，DNS是不保证的，假设有一个web-server挂了，部分服务会受到影响</li> <li>2）扩容非实时：DNS解析有一个生效周期</li> <li>3）暴露了太多的外网ip</li></ul> <h3 id="nginx"><a href="#nginx" class="header-anchor">#</a> <strong>nginx</strong></h3> <p>nginx：一个高性能的web-server和实施反向代理的软件</p> <div style="display:flex;"><img src="/assets/img/lb-27.225b6a50.png" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <ul><li>站点层与浏览器层之间加入了一个反向代理层，利用高性能的nginx来做反向代理</li> <li>nginx将http请求分发给后端多个web-server</li></ul> <p>优点：</p> <ul><li>1）DNS-server不需要动</li> <li>2）负载均衡：通过nginx来保证</li> <li>3）只暴露一个外网ip，nginx-&gt;tomcat之间使用内网访问</li> <li>4）扩容实时：nginx内部可控，随时增加web-server随时实时扩容</li> <li>5）能够保证站点层的可用性：任何一台tomcat挂了，nginx可以将流量迁移到其他tomcat</li></ul> <p>缺点：</p> <ul><li>1）时延增加+架构更复杂了：中间多加了一个反向代理层</li> <li>2）反向代理层成了单点，非高可用</li></ul> <h3 id="keepalived"><a href="#keepalived" class="header-anchor">#</a> <strong>keepalived</strong></h3> <p>keepalived：一款用来检测服务状态存活性的软件，常用来做高可用</p> <div style="display:flex;"><img src="/assets/img/lb-28.f16b07c7.png" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <ul><li>做两台nginx组成一个集群，分别部署上keepalived，设置成相同的虚IP，保证nginx的高可用</li> <li>当一台nginx挂了，keepalived能够探测到，并将流量自动迁移到另一台nginx上，整个过程对调用方透明</li></ul> <div style="display:flex;"><img src="/assets/img/lb-29.a7b54007.png" alt="" align="left" style="zoom:120%;display:block;"></div> <p>优点：</p> <ul><li>1）解决了高可用的问题</li></ul> <p>缺点：</p> <ul><li>1）资源利用率只有50%</li> <li>2）nginx仍然是接入单点</li></ul> <h3 id="lvs-f5-nginx"><a href="#lvs-f5-nginx" class="header-anchor">#</a> <strong>lvs/f5/nginx</strong></h3> <p>lvs/nginx：Linux Virtual Server，使用集群技术，实现在linux操作系统层面的一个高性能、高可用、负载均衡服务器<br>f5：一个高性能、高可用、负载均衡的硬件设备</p> <div style="display:flex;"><img src="/assets/img/lb-30.04ee869d.png" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <ul><li>可以通过lvs/nginx来扩展多个nginx和tomcat（上面的lvs可以用nginx代替）</li> <li>通过keepalived+VIP的方案可以保证可用性</li></ul> <h3 id="水平扩展"><a href="#水平扩展" class="header-anchor">#</a> <strong>水平扩展</strong></h3> <p>水平扩展，才是解决性能问题的根本方案，能够通过加机器扩充性能的方案才具备最好的扩展性</p> <div style="display:flex;"><img src="/assets/img/lb-31.74512bdc.png" alt="" align="left" style="zoom:120%;display:block;"></div> <br> <ul><li>通过DNS轮询来线性扩展入口lvs层的性能</li> <li>通过keepalived来保证高可用</li> <li>通过lvs来扩展多个nginx</li> <li>通过nginx来做负载均衡，业务七层路由</li></ul> <br> <h2 id="四层-七层构建大规模集群架构使用场景"><a href="#四层-七层构建大规模集群架构使用场景" class="header-anchor">#</a> <strong>四层 + 七层构建大规模集群架构使用场景</strong></h2> <p><strong>四层负载均衡应用场景</strong></p> <ol><li>四层+七层来做负载均衡，四层可以保证七层的负载均衡的高可用性；如：nginx就无法保证自己的服务高可用，需要依赖LVS或者keepalive。</li> <li>如：tcp协议的负载均衡，有些请求是TCP协议的（mysql、ssh），或者说这些请求只需要使用四层进行端口的转发就可以了，所以使用四层负载均衡。</li></ol> <p><strong>四层负载均衡总结</strong></p> <ol><li>四层负载均衡仅能转发TCP/IP协议、UDP协议、通常用来转发端口，如：tcp/22、udp/53；</li> <li>四层负载均衡可以用来解决七层负载均衡端口限制问题；（七层负载均衡最大使用65535个端口号）</li> <li>四层负载均衡可以解决七层负载均衡高可用问题；（多台后端七层负载均衡能同时的使用）</li> <li>四层的转发效率比七层的高得多，但仅支持tcp/ip协议，不支持http和https协议；</li> <li>通常大并发场景通常会选择使用在七层负载前面增加四层负载均衡。</li></ol> <div style="display:flex;"><img src="/assets/img/lb-32.0f3723c5.png" alt="" align="left" style="zoom:120%;display:block;"></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/Architect/Microservice/">Microservice</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2ba1140b.js" defer></script><script src="/assets/js/2.858e58ff.js" defer></script><script src="/assets/js/3.753236a7.js" defer></script>
  </body>
</html>
