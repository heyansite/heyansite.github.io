<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Splunk Fundamentals 3 | Yan&#39;s Blog Home</title>
    <meta name="description" content="Personal blog site">
    
    
    <link rel="preload" href="/assets/css/0.styles.ad4900be.css" as="style"><link rel="preload" href="/assets/js/app.251ed5d9.js" as="script"><link rel="preload" href="/assets/js/2.858e58ff.js" as="script"><link rel="preload" href="/assets/js/46.65a6b698.js" as="script"><link rel="prefetch" href="/assets/js/10.5dcc1f52.js"><link rel="prefetch" href="/assets/js/100.c5640ec8.js"><link rel="prefetch" href="/assets/js/101.323d4ccf.js"><link rel="prefetch" href="/assets/js/102.d94a08aa.js"><link rel="prefetch" href="/assets/js/103.678e430d.js"><link rel="prefetch" href="/assets/js/104.b400bd3a.js"><link rel="prefetch" href="/assets/js/105.b6229a45.js"><link rel="prefetch" href="/assets/js/106.3ee7df20.js"><link rel="prefetch" href="/assets/js/107.4a958290.js"><link rel="prefetch" href="/assets/js/108.3ea2d0fb.js"><link rel="prefetch" href="/assets/js/109.e1eb969c.js"><link rel="prefetch" href="/assets/js/11.ff52cad9.js"><link rel="prefetch" href="/assets/js/110.a6e6e273.js"><link rel="prefetch" href="/assets/js/111.a172e2a2.js"><link rel="prefetch" href="/assets/js/112.dfc2a86d.js"><link rel="prefetch" href="/assets/js/113.6df6d874.js"><link rel="prefetch" href="/assets/js/114.302b8495.js"><link rel="prefetch" href="/assets/js/115.8651aa48.js"><link rel="prefetch" href="/assets/js/116.9e1f9a0b.js"><link rel="prefetch" href="/assets/js/117.9a74f4ce.js"><link rel="prefetch" href="/assets/js/118.121a666c.js"><link rel="prefetch" href="/assets/js/119.ca6819f9.js"><link rel="prefetch" href="/assets/js/12.b633635b.js"><link rel="prefetch" href="/assets/js/120.efe65d91.js"><link rel="prefetch" href="/assets/js/121.72958c2e.js"><link rel="prefetch" href="/assets/js/122.72c5fb33.js"><link rel="prefetch" href="/assets/js/123.e94917c1.js"><link rel="prefetch" href="/assets/js/124.11cc8c85.js"><link rel="prefetch" href="/assets/js/125.437fd863.js"><link rel="prefetch" href="/assets/js/126.207eaa74.js"><link rel="prefetch" href="/assets/js/127.125a30c1.js"><link rel="prefetch" href="/assets/js/128.1af89ad7.js"><link rel="prefetch" href="/assets/js/129.269e955a.js"><link rel="prefetch" href="/assets/js/13.4bfed5d6.js"><link rel="prefetch" href="/assets/js/130.3d2d293b.js"><link rel="prefetch" href="/assets/js/131.59e95e31.js"><link rel="prefetch" href="/assets/js/132.46b0ce06.js"><link rel="prefetch" href="/assets/js/133.f24ba32d.js"><link rel="prefetch" href="/assets/js/134.c8fe20d2.js"><link rel="prefetch" href="/assets/js/135.c7a5061f.js"><link rel="prefetch" href="/assets/js/136.b618e419.js"><link rel="prefetch" href="/assets/js/137.940c57e9.js"><link rel="prefetch" href="/assets/js/138.d59a4686.js"><link rel="prefetch" href="/assets/js/139.b2f4f7fd.js"><link rel="prefetch" href="/assets/js/14.49597bec.js"><link rel="prefetch" href="/assets/js/140.44b06552.js"><link rel="prefetch" href="/assets/js/141.f6a6d207.js"><link rel="prefetch" href="/assets/js/142.c86df684.js"><link rel="prefetch" href="/assets/js/143.5fd6fd83.js"><link rel="prefetch" href="/assets/js/144.c803a4cd.js"><link rel="prefetch" href="/assets/js/145.103c81ef.js"><link rel="prefetch" href="/assets/js/146.cd714a4a.js"><link rel="prefetch" href="/assets/js/147.df610887.js"><link rel="prefetch" href="/assets/js/148.3e704f1c.js"><link rel="prefetch" href="/assets/js/149.9291cd1d.js"><link rel="prefetch" href="/assets/js/15.16f4b9c1.js"><link rel="prefetch" href="/assets/js/150.6bf9657f.js"><link rel="prefetch" href="/assets/js/151.5ba13642.js"><link rel="prefetch" href="/assets/js/152.3f4f4ca8.js"><link rel="prefetch" href="/assets/js/153.b93c66a6.js"><link rel="prefetch" href="/assets/js/154.a398d903.js"><link rel="prefetch" href="/assets/js/155.63f86958.js"><link rel="prefetch" href="/assets/js/156.54044f43.js"><link rel="prefetch" href="/assets/js/157.f0e2bcb3.js"><link rel="prefetch" href="/assets/js/158.5b91c0e7.js"><link rel="prefetch" href="/assets/js/159.ab5444bc.js"><link rel="prefetch" href="/assets/js/16.c616e2b6.js"><link rel="prefetch" href="/assets/js/160.2530c91d.js"><link rel="prefetch" href="/assets/js/161.1df05a75.js"><link rel="prefetch" href="/assets/js/162.dad7fc47.js"><link rel="prefetch" href="/assets/js/163.b2d75a8a.js"><link rel="prefetch" href="/assets/js/164.4b49bb3c.js"><link rel="prefetch" href="/assets/js/165.ac1b34cb.js"><link rel="prefetch" href="/assets/js/166.00826470.js"><link rel="prefetch" href="/assets/js/167.e152507a.js"><link rel="prefetch" href="/assets/js/168.e668c315.js"><link rel="prefetch" href="/assets/js/169.c0832495.js"><link rel="prefetch" href="/assets/js/17.c15fd290.js"><link rel="prefetch" href="/assets/js/170.265153fd.js"><link rel="prefetch" href="/assets/js/171.362c431d.js"><link rel="prefetch" href="/assets/js/172.5e1589e8.js"><link rel="prefetch" href="/assets/js/173.7d1fef7b.js"><link rel="prefetch" href="/assets/js/174.e7293e4a.js"><link rel="prefetch" href="/assets/js/175.b28bdea7.js"><link rel="prefetch" href="/assets/js/176.c2d7977b.js"><link rel="prefetch" href="/assets/js/177.377eb895.js"><link rel="prefetch" href="/assets/js/178.1fa90333.js"><link rel="prefetch" href="/assets/js/179.68c5de48.js"><link rel="prefetch" href="/assets/js/18.db4a03ec.js"><link rel="prefetch" href="/assets/js/180.acb281b9.js"><link rel="prefetch" href="/assets/js/181.2be18ec9.js"><link rel="prefetch" href="/assets/js/182.bc60d6b6.js"><link rel="prefetch" href="/assets/js/183.f2919036.js"><link rel="prefetch" href="/assets/js/184.b38aec29.js"><link rel="prefetch" href="/assets/js/185.9a669ac8.js"><link rel="prefetch" href="/assets/js/186.e779fe45.js"><link rel="prefetch" href="/assets/js/187.468bfbe8.js"><link rel="prefetch" href="/assets/js/188.20d2e93c.js"><link rel="prefetch" href="/assets/js/189.42db30b7.js"><link rel="prefetch" href="/assets/js/19.d3b9b0a8.js"><link rel="prefetch" href="/assets/js/190.dea239ec.js"><link rel="prefetch" href="/assets/js/191.ccf9ae83.js"><link rel="prefetch" href="/assets/js/192.e2d30cca.js"><link rel="prefetch" href="/assets/js/193.62867c3e.js"><link rel="prefetch" href="/assets/js/194.13629983.js"><link rel="prefetch" href="/assets/js/195.4b68f3a0.js"><link rel="prefetch" href="/assets/js/196.ff59e8f6.js"><link rel="prefetch" href="/assets/js/197.15e020f7.js"><link rel="prefetch" href="/assets/js/198.4ea70ef4.js"><link rel="prefetch" href="/assets/js/199.56f0c110.js"><link rel="prefetch" href="/assets/js/20.c35dcf39.js"><link rel="prefetch" href="/assets/js/200.78dd9f28.js"><link rel="prefetch" href="/assets/js/201.91a68593.js"><link rel="prefetch" href="/assets/js/202.8a14b96a.js"><link rel="prefetch" href="/assets/js/203.a23a704a.js"><link rel="prefetch" href="/assets/js/204.dab38ee5.js"><link rel="prefetch" href="/assets/js/21.e43c696c.js"><link rel="prefetch" href="/assets/js/22.393983f9.js"><link rel="prefetch" href="/assets/js/23.e302c532.js"><link rel="prefetch" href="/assets/js/24.f4df4e7f.js"><link rel="prefetch" href="/assets/js/25.85aee522.js"><link rel="prefetch" href="/assets/js/26.f3d4bc2d.js"><link rel="prefetch" href="/assets/js/27.03f420d3.js"><link rel="prefetch" href="/assets/js/28.c8ad758a.js"><link rel="prefetch" href="/assets/js/29.acb65439.js"><link rel="prefetch" href="/assets/js/3.753236a7.js"><link rel="prefetch" href="/assets/js/30.fc1f5f5c.js"><link rel="prefetch" href="/assets/js/31.77e58103.js"><link rel="prefetch" href="/assets/js/32.5ef2f040.js"><link rel="prefetch" href="/assets/js/33.fc4584e7.js"><link rel="prefetch" href="/assets/js/34.71ca5ff9.js"><link rel="prefetch" href="/assets/js/35.bd5aae58.js"><link rel="prefetch" href="/assets/js/36.124f8c76.js"><link rel="prefetch" href="/assets/js/37.901c9e05.js"><link rel="prefetch" href="/assets/js/38.61d0edc2.js"><link rel="prefetch" href="/assets/js/39.7921a116.js"><link rel="prefetch" href="/assets/js/4.fdb5e485.js"><link rel="prefetch" href="/assets/js/40.b389d659.js"><link rel="prefetch" href="/assets/js/41.0a58c3f1.js"><link rel="prefetch" href="/assets/js/42.e7961d9e.js"><link rel="prefetch" href="/assets/js/43.af113228.js"><link rel="prefetch" href="/assets/js/44.7560b6a3.js"><link rel="prefetch" href="/assets/js/45.4291ebfa.js"><link rel="prefetch" href="/assets/js/47.2eb4574c.js"><link rel="prefetch" href="/assets/js/48.b0c68533.js"><link rel="prefetch" href="/assets/js/49.020f0482.js"><link rel="prefetch" href="/assets/js/5.29130c00.js"><link rel="prefetch" href="/assets/js/50.b7cb1a11.js"><link rel="prefetch" href="/assets/js/51.efe2b5f7.js"><link rel="prefetch" href="/assets/js/52.a96f1076.js"><link rel="prefetch" href="/assets/js/53.95f7bac7.js"><link rel="prefetch" href="/assets/js/54.476274a8.js"><link rel="prefetch" href="/assets/js/55.41919574.js"><link rel="prefetch" href="/assets/js/56.beb74e07.js"><link rel="prefetch" href="/assets/js/57.705bc19e.js"><link rel="prefetch" href="/assets/js/58.f5fd656b.js"><link rel="prefetch" href="/assets/js/59.04bd0a11.js"><link rel="prefetch" href="/assets/js/6.192ba4c2.js"><link rel="prefetch" href="/assets/js/60.df29a101.js"><link rel="prefetch" href="/assets/js/61.061546fa.js"><link rel="prefetch" href="/assets/js/62.b733d1a1.js"><link rel="prefetch" href="/assets/js/63.926cae9b.js"><link rel="prefetch" href="/assets/js/64.54761bdd.js"><link rel="prefetch" href="/assets/js/65.f2c05d04.js"><link rel="prefetch" href="/assets/js/66.c50ec6bd.js"><link rel="prefetch" href="/assets/js/67.3f1e9d42.js"><link rel="prefetch" href="/assets/js/68.e6d72026.js"><link rel="prefetch" href="/assets/js/69.2de511ae.js"><link rel="prefetch" href="/assets/js/7.162225cc.js"><link rel="prefetch" href="/assets/js/70.65ac284e.js"><link rel="prefetch" href="/assets/js/71.a21ab478.js"><link rel="prefetch" href="/assets/js/72.1da0eaf9.js"><link rel="prefetch" href="/assets/js/73.fcfaf581.js"><link rel="prefetch" href="/assets/js/74.8edbd39c.js"><link rel="prefetch" href="/assets/js/75.70f5ea97.js"><link rel="prefetch" href="/assets/js/76.557c0bb2.js"><link rel="prefetch" href="/assets/js/77.9ce82f4b.js"><link rel="prefetch" href="/assets/js/78.0d809ae3.js"><link rel="prefetch" href="/assets/js/79.a9b07316.js"><link rel="prefetch" href="/assets/js/8.a12bb62b.js"><link rel="prefetch" href="/assets/js/80.fdc72255.js"><link rel="prefetch" href="/assets/js/81.beb8303a.js"><link rel="prefetch" href="/assets/js/82.0cb6ec59.js"><link rel="prefetch" href="/assets/js/83.0f3e946b.js"><link rel="prefetch" href="/assets/js/84.2e2f1d80.js"><link rel="prefetch" href="/assets/js/85.d850d4dd.js"><link rel="prefetch" href="/assets/js/86.32d87d56.js"><link rel="prefetch" href="/assets/js/87.5f97a4f6.js"><link rel="prefetch" href="/assets/js/88.f5b0bbdb.js"><link rel="prefetch" href="/assets/js/89.9f9150f5.js"><link rel="prefetch" href="/assets/js/9.0d992d03.js"><link rel="prefetch" href="/assets/js/90.f69286ce.js"><link rel="prefetch" href="/assets/js/91.cd415cf2.js"><link rel="prefetch" href="/assets/js/92.30ee9be1.js"><link rel="prefetch" href="/assets/js/93.9fc6f609.js"><link rel="prefetch" href="/assets/js/94.3d6138bf.js"><link rel="prefetch" href="/assets/js/95.d6a20d18.js"><link rel="prefetch" href="/assets/js/96.afb03bd8.js"><link rel="prefetch" href="/assets/js/97.14206eba.js"><link rel="prefetch" href="/assets/js/98.0d5b3805.js"><link rel="prefetch" href="/assets/js/99.d81e6ba7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ad4900be.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Yan's Blog Home</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Blog Home</a></div><div class="nav-item"><a href="/index/" class="nav-link">Technical Blog Home</a></div><div class="nav-item"><a href="https://heyan.site:8003/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Other Blog Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/comments.html" class="nav-link">留言</a></div><div class="nav-item"><a href="http://heyan.site/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Site Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Blog Home</a></div><div class="nav-item"><a href="/index/" class="nav-link">Technical Blog Home</a></div><div class="nav-item"><a href="https://heyan.site:8003/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Other Blog Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/comments.html" class="nav-link">留言</a></div><div class="nav-item"><a href="http://heyan.site/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Site Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大数据和分布式系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式系统理论</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式协调服务</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据摄取 Layer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据流 Layer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据存储 Layer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据处理 Layer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据分析 Layer (OLAP)</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式系统基础框架Hadoop</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Data Platform - Splunk</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BigDataAndDistributedSystem/Splunk/" class="sidebar-link">Data Platform - Splunk</a></li><li><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals1.html" class="sidebar-link">Splunk Fundamentals 1</a></li><li><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals2.html" class="sidebar-link">Splunk Fundamentals 2</a></li><li><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html" class="active sidebar-link">Splunk Fundamentals 3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#exploring-statistical-commands" class="sidebar-link">Exploring Statistical Commands</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#reviewing-the-stats-command" class="sidebar-link">Reviewing the stats Command</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#performing-statistical-analysis-with-stats-functions" class="sidebar-link">Performing Statistical Analysis with stats Functions</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#fieldsummary-command" class="sidebar-link">fieldsummary Command</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#fieldsummary-results-table-contents" class="sidebar-link">fieldsummary Results Table Contents</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#appendpipe-command" class="sidebar-link">appendpipe Command</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#appendpipe-command-–-subtotals" class="sidebar-link">appendpipe Command – Subtotals</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#appendpipe-command-–-grand-total" class="sidebar-link">appendpipe Command – Grand Total</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#using-count-and-list-functions" class="sidebar-link">Using count and list Functions</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eventstats-command" class="sidebar-link">eventstats Command</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#streamstats-command" class="sidebar-link">streamstats Command</a></li></ul></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#exploring-eval-command-functions" class="sidebar-link">Exploring eval Command Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#ways-to-write-multiple-evals" class="sidebar-link">Ways to Write Multiple evals</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-conversion-functions" class="sidebar-link">eval Command – Conversion Functions</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-date-and-time-functions" class="sidebar-link">eval Command – Date and Time Functions</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-strftime-function" class="sidebar-link">eval Command – strftime Function</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-relative-time-function" class="sidebar-link">eval Command – relative_time Function</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-strptime-function" class="sidebar-link">eval Command – strptime Function</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-lower-upper-substr" class="sidebar-link">eval Command – lower, upper, substr</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-replace-function" class="sidebar-link">eval Command – replace Function</a></li><li class="sidebar-sub-header"><a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals3.html#eval-command-–-if-function-review" class="sidebar-link">eval Command – if Function Review</a></li></ul></li></ul></li><li><a href="/BigDataAndDistributedSystem/Splunk/SplunkAdvance.html" class="sidebar-link">Splunk 相关知识</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Data Platform - ELK</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/index/" class="sidebar-link">&lt; 首页</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="splunk-fundamentals-3"><a href="#splunk-fundamentals-3" class="header-anchor">#</a> Splunk Fundamentals 3</h1> <div class="custom-block tip"><p class="custom-block-title">参考</p> <ul><li>官网付费Course (<em>based on version: 7.x</em>)</li></ul></div> <h2 id="exploring-statistical-commands"><a href="#exploring-statistical-commands" class="header-anchor">#</a> Exploring Statistical Commands</h2> <h3 id="reviewing-the-stats-command"><a href="#reviewing-the-stats-command" class="header-anchor">#</a> Reviewing the stats Command</h3> <ul><li>Enables you to calculate statistics on data that match your search criteria</li> <li>stats functions you’ve seen in previous courses include:
<ul><li><strong>count</strong>: returns the number of events that match the search criteria</li> <li><strong>distinct_count</strong> or <strong>dc</strong>: returns a count of unique values for a given field - sum: returns a sum of numeric values</li> <li><strong>list</strong>: lists all values of a given field</li> <li><strong>values</strong>: lists unique values of a given field</li></ul></li></ul> <h3 id="performing-statistical-analysis-with-stats-functions"><a href="#performing-statistical-analysis-with-stats-functions" class="header-anchor">#</a> Performing Statistical Analysis with stats Functions</h3> <p>A variety of other stats functions are available for more detailed statistical information, including:</p> <ul><li><strong>min</strong>: minimum value</li> <li><strong>max</strong>: maximum value</li> <li><strong>avg</strong> or <strong>mean</strong>: average value</li> <li><strong>median</strong>: “middle” value</li> <li><strong>range</strong>: difference between minimum and maximum values</li> <li><strong>stdev</strong>（标准差）: standard deviation (measure of the extent of deviation of the values)</li> <li><strong>var</strong>（方差）: variance (measure of how far the values are spread out)</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">index</span><span class="token operator">=</span>sales sourcetype<span class="token operator">=</span>vendor_sales VendorID<span class="token operator">&gt;=</span><span class="token number">7000</span> <span class="token operator">AND</span> VendorID<span class="token operator">&lt;</span><span class="token number">9000</span>

<span class="token operator">|</span> stats <span class="token function">count</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> count<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> sum<span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> Minimum<span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> Maximum<span class="token punctuation">,</span> 
range<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> Range<span class="token punctuation">,</span> mean<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> Average<span class="token punctuation">,</span> median<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> Median<span class="token punctuation">,</span> 
stdev<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> sdev<span class="token punctuation">,</span> var<span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> Variance <span class="token keyword">by</span> VendorCountry

<span class="token operator">|</span> eval Average <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>Average<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sdev <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>sdev<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Variance <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>Variance<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">|</span> sort <span class="token operator">-</span>sum
<span class="token operator">|</span> <span class="token keyword">rename</span> count <span class="token keyword">as</span> <span class="token string">&quot;Units Sold&quot;</span><span class="token punctuation">,</span> sum <span class="token keyword">as</span> <span class="token string">&quot;Total Sales&quot;</span><span class="token punctuation">,</span> sdev <span class="token keyword">as</span>
<span class="token string">&quot;Standard Deviation&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>标准差：是离均差平方的算术平均数（即：方差）的算术平方根</p> <p>方差=标准差的平方</p></blockquote> <div style="display:flex;"><img src="/assets/img/splunkstart3-1.6050e07f.png" alt="" align="left" style="zoom:100%;display:block;"></div> <h3 id="fieldsummary-command"><a href="#fieldsummary-command" class="header-anchor">#</a> fieldsummary Command</h3> <ul><li>Calculates a variety of summary stats for all or a subset of fields</li> <li>Displays summary info as results table</li> <li>Syntax: <code>... | fieldsummary [maxvals=num] [field-list]</code></li> <li>Takes optional arguments
<ul><li>maxvals: maximum distinct values to return for each field</li> <li>field-list: list of fields to calculate statistics for</li></ul></li></ul> <h3 id="fieldsummary-results-table-contents"><a href="#fieldsummary-results-table-contents" class="header-anchor">#</a> fieldsummary Results Table Contents</h3> <ul><li><strong>field</strong>: field name</li> <li><strong>count</strong>: number of events with that field</li> <li><strong>distinct_count</strong>: number of unique values in field</li> <li><strong>is_exact</strong>: Boolean (0 or 1) indicating whether distinct_count is exact</li> <li><strong>mean</strong> (if field numeric)</li> <li><strong>min</strong> (if field numeric)</li> <li><strong>numeric_count</strong>: count of numeric values in field</li> <li><strong>stdev</strong> (if field numeric)</li> <li><strong>values</strong>: distinct values of field and count of each value - 如果distinct值很多，可使用maxval限制</li> <li><strong>max</strong> (if field numeric)</li></ul> <blockquote><p>if no maxvals is specified, then is_exact will always equal 1.</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
A data scientist at Buttercup Games wants to study the variance of data in all 
Web events collected over the past 15 minutes.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web earliest<span class="token operator">=</span><span class="token operator">-</span><span class="token number">15</span>m latest<span class="token operator">=</span>now 
<span class="token operator">|</span> fieldsummary
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
SecOps manager wants to compare a sampling of IP addresses from 
the security index over the past 24 hours.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>security earliest<span class="token operator">=</span><span class="token operator">-</span><span class="token number">24</span>h latest<span class="token operator">=</span>now
<span class="token operator">|</span> fieldsummary maxvals<span class="token operator">=</span><span class="token number">10</span> bcg_ip src_ip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="appendpipe-command"><a href="#appendpipe-command" class="header-anchor">#</a> appendpipe Command</h3> <ul><li>appendpipe
<ol><li>Takes the existing results and pushes them into the sub-pipeline</li> <li>Then, appends the result of the sub-pipeline as new lines to the outer search</li></ol></li> <li>Results are displayed in-line</li> <li>Example: appendpipe [stats sum(count) as count by usage]</li></ul> <h3 id="appendpipe-command-–-subtotals"><a href="#appendpipe-command-–-subtotals" class="header-anchor">#</a> appendpipe Command – Subtotals</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
IT wants to find the number of non-business related connections 
to the Internet for the last 24 hours, by user and total attempts by usage.
*/</span>

<span class="token comment">/*
• Look for usage other than
Business
• Count number of connections by usage and user
• Add a subtotal below each group of usage values
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>network sourcetype<span class="token operator">=</span>cisco_wsa_squid <span class="token keyword">usage</span><span class="token operator">!=</span>Business 
<span class="token operator">|</span> stats count <span class="token keyword">by</span> <span class="token keyword">usage</span><span class="token punctuation">,</span> cs_username 
<span class="token operator">|</span> appendpipe <span class="token punctuation">[</span>stats <span class="token function">sum</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> count <span class="token keyword">by</span> <span class="token keyword">usage</span><span class="token punctuation">]</span> 
<span class="token operator">|</span> sort <span class="token keyword">usage</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*Use eval to provide a description for the accumulated field*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>network sourcetype<span class="token operator">=</span>cisco_wsa_squid <span class="token keyword">usage</span><span class="token operator">!=</span>Business 
<span class="token operator">|</span> stats count <span class="token keyword">by</span> <span class="token keyword">usage</span><span class="token punctuation">,</span> cs_username
<span class="token operator">|</span> appendpipe <span class="token punctuation">[</span>stats <span class="token function">sum</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> count <span class="token keyword">by</span> <span class="token keyword">usage</span> 
	<span class="token operator">|</span> eval cs_username<span class="token operator">=</span><span class="token string">&quot;Total for usage of &quot;</span><span class="token punctuation">.</span><span class="token keyword">usage</span><span class="token punctuation">]</span> 
<span class="token operator">|</span> sort <span class="token keyword">usage</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="appendpipe-command-–-grand-total"><a href="#appendpipe-command-–-grand-total" class="header-anchor">#</a> appendpipe Command – Grand Total</h3> <ul><li>Can use multiple appendpipe commands</li> <li>The second appendpipe adds a grand total to the end of the report</li> <li>If there is more than one page, the grand total displays on the last page</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario: 
Sec Ops wants the number of non- business related connections to the Internet for the last 4 hours, 
by user and total attempts by usage. They also want a subtotal of total attempts by usage and a grand total.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>network sourcetype<span class="token operator">=</span>cisco_wsa_squid <span class="token keyword">usage</span><span class="token operator">!=</span>Business 
<span class="token operator">|</span> stats count <span class="token keyword">by</span> <span class="token keyword">usage</span><span class="token punctuation">,</span> cs_username
<span class="token operator">|</span> appendpipe <span class="token punctuation">[</span>stats <span class="token function">sum</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> count <span class="token keyword">by</span> <span class="token keyword">usage</span> 
	<span class="token operator">|</span> eval cs_username <span class="token operator">=</span> <span class="token string">&quot;Total for usage of &quot;</span><span class="token punctuation">.</span><span class="token keyword">usage</span><span class="token punctuation">]</span> 
<span class="token operator">|</span> appendpipe <span class="token punctuation">[</span>search cs_username<span class="token operator">=</span><span class="token string">&quot;Total for*&quot;</span>
<span class="token operator">|</span> stats <span class="token function">sum</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> count
<span class="token operator">|</span> eval cs_username <span class="token operator">=</span> <span class="token string">&quot;GRAND TOTAL&quot;</span><span class="token punctuation">]</span> 
<span class="token operator">|</span> sort <span class="token keyword">usage</span><span class="token punctuation">,</span> count
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div style="display:flex;"><img src="/assets/img/splunkstart3-2.de111d2b.png" alt="" align="left" style="zoom:100%;display:block;"></div> <h3 id="using-count-and-list-functions"><a href="#using-count-and-list-functions" class="header-anchor">#</a> Using count and list Functions</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
	<span class="token keyword">action</span><span class="token operator">=</span>purchase <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">200</span>
<span class="token operator">|</span> stats count <span class="token keyword">by</span> host<span class="token punctuation">,</span> product_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用上面的语句，我们会得到下图左边的结果。</p> <div style="display:flex;"><img src="/assets/img/splunkstart3-3.d8b99e3c.png" alt="" align="left" style="zoom:100%;display:block;"></div> <p>要想得到右边这种更加友好的结果，使用如下语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined <span class="token keyword">action</span><span class="token operator">=</span>purchase <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">200</span> 
<span class="token operator">|</span> stats count <span class="token keyword">by</span> host<span class="token punctuation">,</span> product_name
<span class="token operator">|</span> sort <span class="token operator">-</span>count
<span class="token operator">|</span> stats list<span class="token punctuation">(</span>product_name<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;Product Name&quot;</span><span class="token punctuation">,</span> 
		list<span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> Count  <span class="token keyword">by</span> host
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
Sorted descending by count, per host
*/</span>

<span class="token comment">/*sum(count) as total sums the count values for each host into a new field called total
– Used to sort
– Removed from results
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined product_name<span class="token operator">=</span><span class="token operator">*</span> <span class="token operator">|</span> stats count <span class="token keyword">by</span> host<span class="token punctuation">,</span> product_name
<span class="token operator">|</span> sort <span class="token operator">-</span>count
<span class="token operator">|</span> stats list<span class="token punctuation">(</span>product_name<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;Product Name&quot;</span><span class="token punctuation">,</span>
  list<span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> Count<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> total <span class="token keyword">by</span> host
<span class="token operator">|</span> sort <span class="token operator">-</span>total
<span class="token operator">|</span> <span class="token keyword">fields</span> <span class="token operator">-</span> total
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="eventstats-command"><a href="#eventstats-command" class="header-anchor">#</a> eventstats Command</h3> <ul><li>Generates summary statistics of all existing fields in your search results （也就是eventstats 是对最初search的结果进行统计，而不是对上一个pipline的结果）</li> <li>Saves them as values in new fields</li> <li>Both original fields and summary stats are then available for calculations</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
For a new campaign, 
the online sales manager wants a display of products that 
are losing more sales than the average during the last 24 hours.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined <span class="token keyword">action</span><span class="token operator">=</span>remove
<span class="token operator">|</span> chart <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> lostSales <span class="token keyword">by</span> product_name
<span class="token operator">|</span> eventstats <span class="token function">avg</span><span class="token punctuation">(</span>lostSales<span class="token punctuation">)</span> <span class="token keyword">as</span> averageLoss
<span class="token operator">|</span> <span class="token keyword">where</span> lostSales <span class="token operator">&gt;</span> averageLoss
<span class="token operator">|</span> sort <span class="token operator">-</span>lostSales
<span class="token operator">|</span> <span class="token keyword">fields</span> <span class="token operator">-</span> averageLoss

<span class="token comment">/*
• Find the aggregate ‘lost sales’ by product
• Use eventstats to calculate the average loss
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
The sales team want to know the lowest and highest sales totals during the previous week 
– and on which days they occurred.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token operator">|</span> timechart <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> totalSales
<span class="token operator">|</span> eventstats <span class="token function">max</span><span class="token punctuation">(</span>totalSales<span class="token punctuation">)</span> <span class="token keyword">as</span> highest<span class="token punctuation">,</span> 
	<span class="token function">min</span><span class="token punctuation">(</span>totalSales<span class="token punctuation">)</span> <span class="token keyword">as</span> lowest 
<span class="token operator">|</span> <span class="token keyword">where</span> totalSales<span class="token operator">=</span>highest <span class="token operator">OR</span> totalSales<span class="token operator">=</span>lowest 
<span class="token operator">|</span> eval Outcome <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>totalSales<span class="token operator">=</span>highest<span class="token punctuation">,</span><span class="token string">&quot;Highest&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Lowest&quot;</span><span class="token punctuation">)</span> 
<span class="token operator">|</span> eval <span class="token keyword">Day</span> <span class="token operator">=</span> strftime<span class="token punctuation">(</span>_time<span class="token punctuation">,</span><span class="token string">&quot;%A&quot;</span><span class="token punctuation">)</span> 
<span class="token operator">|</span> <span class="token keyword">table</span> <span class="token keyword">Day</span><span class="token punctuation">,</span> Outcome<span class="token punctuation">,</span> totalSales
<span class="token operator">|</span> eval totalSales <span class="token operator">=</span> <span class="token string">&quot;$&quot;</span><span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>totalSales<span class="token punctuation">,</span><span class="token string">&quot;commas&quot;</span><span class="token punctuation">)</span>

<span class="token comment">/*
result:
----------------------------------------
|Day		|Outcome	|totalSales|
|Monday		|Lowest		|$46,994.83|
|Saturday	|Highest	|$51,616.77|
----------------------------------------

- Using min, determine the lowest value
- Using max, determine the highest value
- Label highest and lowest values
- Label day of the week
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="streamstats-command"><a href="#streamstats-command" class="header-anchor">#</a> streamstats Command</h3> <ul><li>Like eventstats command, calculates summary stats on search results and aggregates stats to original data (和eventstats一样，对search后的源结果进行总结统计)</li> <li>But:
<ul><li>stats and eventstats work on the entire results</li> <li>streamstats calculates statistics <em>for each result row at the time the command encounters it</em></li></ul></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
Sales wants to monitor a moving average of the price of a purchase on the Buttercup Games website 
over the previous 20 purchases during the last 24 hours.
*/</span>
<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token keyword">action</span><span class="token operator">=</span>purchase <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">200</span> productId<span class="token operator">=</span><span class="token operator">*</span>
<span class="token operator">|</span> <span class="token keyword">table</span> _time<span class="token punctuation">,</span> price
<span class="token operator">|</span> sort _time
<span class="token operator">|</span> streamstats <span class="token function">avg</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> averageOrder
<span class="token keyword">current</span><span class="token operator">=</span>f window<span class="token operator">=</span><span class="token number">20</span>

<span class="token comment">/*
• Calculate the average price over the past 20 events (window=20)
• Do not include current event in summary calculations (current=f)
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
SecOps manager wants the network failures for the last 4 hours by user with the IPs, rank and number of failures.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>security sourcetype<span class="token operator">=</span>linux_secure fail<span class="token operator">*</span>
<span class="token operator">|</span> stats count <span class="token keyword">by</span> <span class="token keyword">user</span><span class="token punctuation">,</span> src_ip
<span class="token operator">|</span> sort <span class="token operator">-</span>count
<span class="token operator">|</span> streamstats count <span class="token keyword">as</span> ip_order <span class="token keyword">by</span> <span class="token keyword">user</span>
<span class="token operator">|</span> stats list<span class="token punctuation">(</span>ip_order<span class="token punctuation">)</span> <span class="token keyword">as</span> ip_order<span class="token punctuation">,</span>
  list<span class="token punctuation">(</span>src_ip<span class="token punctuation">)</span> <span class="token keyword">as</span> suspectIPs<span class="token punctuation">,</span>
  list<span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token keyword">as</span> count <span class="token keyword">by</span> <span class="token keyword">user</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div style="display:flex;"><img src="/assets/img/splunkstart3-4.a101ff00.png" alt="" align="left" style="zoom:100%;display:block;"></div> <h2 id="exploring-eval-command-functions"><a href="#exploring-eval-command-functions" class="header-anchor">#</a> Exploring eval Command Functions</h2> <h3 id="ways-to-write-multiple-evals"><a href="#ways-to-write-multiple-evals" class="header-anchor">#</a> Ways to Write Multiple evals</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*
Separate eval commands
– The way multiple evals were written prior to Splunk 7.0
– Still works, but no longer necessary
*/</span>
<span class="token keyword">index</span><span class="token operator">=</span>network sourcetype<span class="token operator">=</span>cisco_wsa_squid
<span class="token operator">|</span> stats <span class="token function">sum</span><span class="token punctuation">(</span>sc_bytes<span class="token punctuation">)</span> <span class="token keyword">as</span> bytes <span class="token keyword">by</span> <span class="token keyword">usage</span>
<span class="token operator">|</span> eval bandwidth <span class="token operator">=</span> bytes<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span>
<span class="token operator">|</span> eval bandwidth <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>bandwidth<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">/*
Combined eval command 
– Syntax allowed starting with Splunk 7.0
– Easier and more concise
*/</span>
<span class="token keyword">index</span><span class="token operator">=</span>network sourcetype<span class="token operator">=</span>cisco_wsa_squid
<span class="token operator">|</span> stats <span class="token function">sum</span><span class="token punctuation">(</span>sc_bytes<span class="token punctuation">)</span> <span class="token keyword">as</span> bytes <span class="token keyword">by</span> <span class="token keyword">usage</span>
<span class="token operator">|</span> eval bandwidth <span class="token operator">=</span> bytes<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
bandwidth <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>bandwidth<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">/*
Nested eval command
– If same field is the target of multiple eval commands, you can nest them
*/</span>
<span class="token keyword">index</span><span class="token operator">=</span>network sourcetype<span class="token operator">=</span>cisco_wsa_squid
<span class="token operator">|</span> stats <span class="token function">sum</span><span class="token punctuation">(</span>sc_bytes<span class="token punctuation">)</span> <span class="token keyword">as</span> bytes <span class="token keyword">by</span> <span class="token keyword">usage</span>
<span class="token operator">|</span> eval bandwidth <span class="token operator">=</span> <span class="token function">round</span><span class="token punctuation">(</span>bytes<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token comment">/*All 3 statements produce same results*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="eval-command-–-conversion-functions"><a href="#eval-command-–-conversion-functions" class="header-anchor">#</a> eval Command – Conversion Functions</h3> <ul><li><strong>tostring</strong>: converts a numeric field value to a string</li> <li><strong>tonumber</strong>: converts a field or string value to numeric</li> <li><strong>printf</strong>: builds a string value based on a string format and optional arguments</li></ul> <p><strong>tostring</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*
tostring(field,&quot;option&quot;)
Options:
- &quot;commas&quot;: applies commas
	If the number includes decimals, rounds to two decimal places 
- &quot;duration&quot;: formats the number as &quot;hh:mm:ss&quot;
- &quot;hex&quot;: formats the number in hexadecimal
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token keyword">action</span><span class="token operator">=</span>purchase <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">503</span>
<span class="token operator">|</span> stats <span class="token function">count</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> NumberOfLostSales<span class="token punctuation">,</span>
  <span class="token function">avg</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> AverageLostSales<span class="token punctuation">,</span>
  <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> TotalLostRevenue
<span class="token operator">|</span> eval AverageLostSales <span class="token operator">=</span>
	<span class="token string">&quot;$&quot;</span> <span class="token operator">+</span> tostring<span class="token punctuation">(</span>AverageLostSales<span class="token punctuation">,</span> <span class="token string">&quot;commas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	TotalLostRevenue <span class="token operator">=</span>
	<span class="token string">&quot;$&quot;</span> <span class="token operator">+</span> tostring<span class="token punctuation">(</span>TotalLostRevenue<span class="token punctuation">,</span> <span class="token string">&quot;commas&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>tonumber</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*
tonumber(numstr[,base])
- numstr may be field name or literal string value
- Optional base may be 2 to 36
*/</span>

<span class="token comment">// – Convert string values for the field store_sales to numeric</span>
<span class="token operator">|</span> eval numeric_store_sales<span class="token operator">=</span>tonumber<span class="token punctuation">(</span>store_sales<span class="token punctuation">)</span>

<span class="token comment">//– Convert the octal number (base-8) 244 and the hexadecimal number (base-16)</span>
A4 <span class="token keyword">to</span> <span class="token keyword">decimal</span>
<span class="token operator">|</span> eval n1<span class="token operator">=</span>tonumber<span class="token punctuation">(</span><span class="token string">&quot;244&quot;</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n2<span class="token operator">=</span>tonumber<span class="token punctuation">(</span><span class="token string">&quot;A4&quot;</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>printf</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/*
`printf(&quot;format&quot;,[arguments])`

- Print formatting function, similar to printf used in C, C++, Java, etc.
- format: character string with one or more format conversion specifiers, such as:
    – %d or %i: integers
    – %f or %F: floating point numbers
    – %s or %z: strings
    – %o: octal numbers (base-8)
    – %x or %X or %p: hexadecimal numbers (base-16)
- arguments: optional parameters that can control the width, precision, and value of format
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token keyword">action</span><span class="token operator">=</span>purchase price<span class="token operator">=</span><span class="token operator">*</span>
<span class="token operator">|</span> stats <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> TotalRevenue <span class="token keyword">by</span> categoryId
<span class="token operator">|</span> eval FormattedTotalRevenue<span class="token operator">=</span>
printf<span class="token punctuation">(</span><span class="token string">&quot;%.4f %-30s&quot;</span><span class="token punctuation">,</span>TotalRevenue<span class="token punctuation">,</span><span class="token string">&quot;Dollars&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token keyword">table</span> categoryId<span class="token punctuation">,</span> FormattedTotalRevenue

<span class="token comment">/*
Formats floating point number with 4 digits after decimal point
Left-justifies the value in a string field 30 spaces long (左对齐字符串字段中的值，长度为30个空格)
Appends another value to the end of the string (在结果字符串后面 追加 “Dollars” - 例： “624.7000 Dollars”)
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="eval-command-–-date-and-time-functions"><a href="#eval-command-–-date-and-time-functions" class="header-anchor">#</a> eval Command – Date and Time Functions</h3> <ul><li>now(): returns the time a search was started</li> <li>time(): returns the time an event was processed by the eval command</li> <li>strftime: converts a timestamp to a string format</li> <li>strptime: converts a time in string format and parses it into a timestamp</li> <li>relative_time: returns a timestamp relative to a supplied time</li></ul> <h3 id="eval-command-–-strftime-function"><a href="#eval-command-–-strftime-function" class="header-anchor">#</a> eval Command – strftime Function</h3> <p><code>strftime(X,Y)</code></p> <ul><li>strftime converts epoch time to a readable format</li> <li>Uses variables such as:</li></ul> <blockquote><p><strong>Time</strong><br>
%H 24 hour (00 to 23)<br>%T 24 hour (HMS) <br>%I 12 hour (01 to 12) <br>%M Minute (00 to 59) <br>%p AM or PM</p> <br> <p><strong>Days</strong><br>
%d Day of month (01 to 31)<br>%w Weekday (0 to 6)<br>%F %Y-%m-%d<br>%a Abbreviated weekday (Sun)<br>%A Weekday (Sunday)</p> <br> <p><strong>Month</strong><br>
%b Abbr month name (Jan)<br>%B Month name (January) <br>%m Month number (01 to 12)</p></blockquote> <ul><li><p>Use strftime with the now() function to display the date on which the search is executed</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code> <span class="token operator">|</span> eval searchDate<span class="token operator">=</span>strftime<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;%B-%d-%Y&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>Use strftime with the time() function to display the time at which the event is processed by the eval command</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">|</span> eval eventTime<span class="token operator">=</span>strftime<span class="token punctuation">(</span><span class="token keyword">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;%I:%M %p&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
SalesOps wants to know what hourly retail sales were during the past 24 hours.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>sales sourcetype<span class="token operator">=</span>vendor_sales
<span class="token operator">|</span> timechart span<span class="token operator">=</span><span class="token number">1</span>h <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> h_sales
<span class="token operator">|</span> eval h_sales <span class="token operator">=</span><span class="token string">&quot;$&quot;</span> <span class="token operator">+</span> tostring<span class="token punctuation">(</span>h_sales<span class="token punctuation">,</span><span class="token string">&quot;commas&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> eval <span class="token keyword">Hour</span><span class="token operator">=</span>strftime<span class="token punctuation">(</span>_time<span class="token punctuation">,</span> <span class="token string">&quot;%b %d, %I %p&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token keyword">table</span> <span class="token keyword">Hour</span><span class="token punctuation">,</span> h_sales
<span class="token operator">|</span> <span class="token keyword">rename</span> h_sales <span class="token keyword">as</span> <span class="token string">&quot;Hourly Sales&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="eval-command-–-relative-time-function"><a href="#eval-command-–-relative-time-function" class="header-anchor">#</a> eval Command – relative_time Function</h3> <p><code>relative_time(x,y)</code></p> <ul><li>x = a time value and y = a relative time specifier</li> <li>Relative time specifiers use time unit abbreviations such as:<br> <code>s=seconds m=minutes h=hours d=days w=week mon=months y=year</code></li> <li>Example: return a timestamp one day prior to when the search was started and convert it into a string format<div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">|</span> eval yesterday<span class="token operator">=</span>relative_time<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;-1d@h&quot;</span><span class="token punctuation">)</span> 
<span class="token operator">|</span> eval yesterday<span class="token operator">=</span>strftime<span class="token punctuation">(</span>yesterday<span class="token punctuation">,</span><span class="token string">&quot;%F %H:%M&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h3 id="eval-command-–-strptime-function"><a href="#eval-command-–-strptime-function" class="header-anchor">#</a> eval Command – strptime Function</h3> <p><code>strptime(x,y)</code></p> <ul><li>x = a time represented by a string</li> <li>y = a timestamp format (using same variables as strftime)</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
Admin wants to find any web events that are lagging between when the event occured and when it was indexed in Splunk within the last 60 minutes.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token operator">|</span> eval unix_req_time<span class="token operator">=</span>strptime<span class="token punctuation">(</span>req_time<span class="token punctuation">,</span> <span class="token string">&quot;%d/%b/%Y:%H:%M:%S&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
delta<span class="token operator">=</span>_indextime <span class="token operator">-</span> unix_req_time
<span class="token operator">|</span> <span class="token keyword">rename</span> _indextime <span class="token keyword">as</span> index_time
<span class="token operator">|</span> <span class="token keyword">where</span> delta <span class="token operator">&gt;</span> <span class="token number">0</span>
<span class="token operator">|</span> <span class="token keyword">table</span> clientip<span class="token punctuation">,</span> index_time<span class="token punctuation">,</span> req_time<span class="token punctuation">,</span> unix_req_time<span class="token punctuation">,</span> delta 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="eval-command-–-lower-upper-substr"><a href="#eval-command-–-lower-upper-substr" class="header-anchor">#</a> eval Command – lower, upper, substr</h3> <ul><li>lower(X): converts string to lower-case</li> <li>upper(X): converts string to upper-case</li> <li>substr(X,Y,Z) <br>
– X is a string, Y and Z numerics<br>– Returns a substring of X, starting at the index specified by Y, with a length of Z <br>– If no Z specified, returns the rest of string starting with the index specified by Y</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
User wants to create a new field with 3 first letters of categoryId, uppercase product name, and last digits of the itemId.
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token operator">|</span> dedup product_name<span class="token punctuation">,</span> categoryId<span class="token punctuation">,</span> itemId
<span class="token operator">|</span> eval lowercase_product<span class="token operator">=</span>lower<span class="token punctuation">(</span>product_name<span class="token punctuation">)</span><span class="token punctuation">,</span>
  uppercase_product<span class="token operator">=</span>upper<span class="token punctuation">(</span>product_name<span class="token punctuation">)</span><span class="token punctuation">,</span>
  substr_category<span class="token operator">=</span>substr<span class="token punctuation">(</span>categoryId<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  substr_item<span class="token operator">=</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">(</span>itemId<span class="token punctuation">,</span><span class="token string">&quot;EST-\d {2}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  substr<span class="token punctuation">(</span>itemId<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substr<span class="token punctuation">(</span>itemId<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">|</span> <span class="token keyword">table</span> lowercase_product<span class="token punctuation">,</span> uppercase_product<span class="token punctuation">,</span>
  categoryId<span class="token punctuation">,</span> substr_category<span class="token punctuation">,</span> itemId<span class="token punctuation">,</span> substr_item
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="eval-command-–-replace-function"><a href="#eval-command-–-replace-function" class="header-anchor">#</a> eval Command – replace Function</h3> <p><code>replace(X,Y,Z)</code></p> <ul><li>X, Y, and Z are all strings</li> <li>Y contains a <strong>regex</strong></li> <li>Returns a string formed by substituting Z for every occurrence of Y in X</li> <li>Useful for masking data such as account numbers and IP addresses</li> <li>As with all eval commands, doesn’t alter the indexed data nor write any new data to the index</li></ul> <p><em>Example</em>:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
The Legal department wants to be sure customer account number data is not exposed. Find the count of sales in the last hour by account number. Mask the account number in the result.

- In this example, the customer account numbers in the indexed data is formatted: 9999-9999
*/</span>

<span class="token comment">/*
The regex masks the account code by:
– Retaining the first 4 digits and the hyphen (\d{4}-), and
– Replacing what follows, .*, with xxxx
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>sales sourcetype<span class="token operator">=</span>sales_entries
<span class="token operator">|</span> <span class="token keyword">top</span> AcctCode
<span class="token operator">|</span> eval AcctCode <span class="token operator">=</span> <span class="token keyword">replace</span><span class="token punctuation">(</span>AcctCode<span class="token punctuation">,</span><span class="token string">&quot;(\d{4}-).*&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;\1xxxx&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
Show sales information for the 3 best-selling products of the last 24 hours. Mask the middle octets of the customer IP addresses.
*/</span>

 <span class="token keyword">index</span><span class="token operator">=</span>web sourcetype<span class="token operator">=</span>access_combined
<span class="token operator">|</span> chart <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> totalSales <span class="token keyword">over</span> clientip <span class="token keyword">by</span> product_name
  <span class="token keyword">limit</span><span class="token operator">=</span><span class="token number">3</span> useother<span class="token operator">=</span>f
<span class="token operator">|</span> eval clientip <span class="token operator">=</span> 
	<span class="token keyword">replace</span><span class="token punctuation">(</span>clientip<span class="token punctuation">,</span> <span class="token string">&quot;(\d+\.)\d+\.\d+(\.\d+)&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;\1xxx.xxx\2&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> fillnull
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="eval-command-–-if-function-review"><a href="#eval-command-–-if-function-review" class="header-anchor">#</a> eval Command – if Function Review</h3> <p><code>if(X,Y,Z)</code></p> <ul><li>The if function takes three arguments</li> <li>Thefirstargument,X, isaBooleanexpression<br>- If it evaluates to TRUE, the result evaluates to the second argument, <em>Y</em> <br>- If it evaluates to FALSE, the result evaluates to the third argument, <em>Z</em></li> <li>Non-numeric values must be enclosed in double quotes</li> <li>Field values are treated in a case-sensitive manner</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* Scenario:
Display retail sales for the previous week, broken down by Asia and the Rest of the World.
*/</span>

<span class="token comment">/*
• Create a new field, SalesTerritory 
• Evaluate VendorID
	– If &gt;= 7000 AND &lt; 8000 is TRUE, set result to &quot;Asia&quot;
		-Remember, arguments must be enclosed in quotes
	– If it evaluates to FALSE, set result to &quot;Rest of the World&quot;
*/</span>

<span class="token keyword">index</span><span class="token operator">=</span>sales sourcetype<span class="token operator">=</span>vendor_sales
<span class="token operator">|</span> eval SalesTerritory <span class="token operator">=</span>
 	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>VendorID <span class="token operator">&gt;=</span> <span class="token number">7000</span> <span class="token operator">AND</span> VendorID <span class="token operator">&lt;</span> <span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;Asia&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Rest of the World&quot;</span><span class="token punctuation">)</span>
<span class="token operator">|</span> stats <span class="token function">sum</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">as</span> TotalRevenue <span class="token keyword">by</span> SalesTerritory
<span class="token operator">|</span> eval TotalRevenue <span class="token operator">=</span> <span class="token string">&quot;$&quot;</span> <span class="token operator">+</span> tostring<span class="token punctuation">(</span>TotalRevenue<span class="token punctuation">,</span> <span class="token string">&quot;commas&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/BigDataAndDistributedSystem/Splunk/SplunkFundmentals2.html" class="prev">Splunk Fundamentals 2</a></span> <span class="next"><a href="/BigDataAndDistributedSystem/Splunk/SplunkAdvance.html">Splunk 相关知识</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.251ed5d9.js" defer></script><script src="/assets/js/2.858e58ff.js" defer></script><script src="/assets/js/46.65a6b698.js" defer></script>
  </body>
</html>
